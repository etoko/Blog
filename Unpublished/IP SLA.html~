<h1>IP Service Level Agreement (IP SLAs) and Object Tracking</h1>
<h1>IP SLA</h1>
<p>
Cisco IOS IP SLAs is used for measuring network performance and device availability.
This is accomplished through the generation of network traffic (probes) in a 
continuous, reliable, and predictable manner by a source device to a responder 
device.  
The information collected by IP SLA includes data about response time, one-way 
latency, jitter (interpacket delay variance), packet loss, voice quality scoring, 
network resource availability, application performance, and server response time
for services such as DHCP, DNS. 
IP SLAs performs active monitoring by generating and analyzing traffic to measure 
performance either between Cisco devices or from a Cisco device to a remote IP 
device such as a network application server. Measurement statistics provided by 
the various IP SLAs operations can be used for troubleshooting, for problem 
analysis, and for designing network topologies.
</p>
<p>  
Performance metrics collected by IP SLAs operations include the following:
<ul>
  <li>Delay (both round-trip and one-way) </li>
  <li>Jitter (directional)                </li>
  <li>Packet loss (directional)           </li>
  <li>Packet sequencing (packet ordering) </li>
  <li>Path (per hop)                      </li>
  <li>Connectivity (directional)          </li>
  <li>Server or website download time     </li>
  <li>Voice quality scores                </li>
</ul>
</p>

<h2>Benefits of IP SLAs</h2>
<p>
<ul>
  <li><b>Network performance monitoring:</b> measures the jitter, latency, or 
  packet loss in the network through continuous, reliable, and predictable 
  measurements.</li>
  <li><b>IP service network health assessment:</b> verifies that the existing 
  QoS is sufficient for new IP services.</li>
  <li><b>Network availability monitoring:</b> monitoring the availability of network 
  services such as DHCP, file servers.</li>
  <li><b>Troubleshooting of network operation:</b> provides consistent, reliable, 
  measurement that immediately identifies problems and saves troubleshooting time.
  </li>
</ul>
</p>


<h1>Types of IP SLAs</h1>
<p> 
IP SLAs operations support the following capabiliies:
<ul>
  <li>Domain Name System (DNS) response times</li>
  <li>Dynamic Host Control Protocol (DHCP) server discovery and response times</li>
  <li>File Transfer Protocol (FTP) server response time</li>
  <li>Hypertext Transfer Protocol (HTTP) server response time</li>
  <li>ICMP echo                                       </li> 
  <li>ICMP jitter                                     </li>
  <li>ICMP path echo                                  </li>
  <li>ICMP path jitter                                </li>
  <li>Real-Time Transport Protocol (RTP)-based VoIP   </li>
  <li>Transmission Control Protocol (TCP) connect     </li>
  <li>UDP echo                                        </li>
  <li>UDP jitter                                      </li>
  <li>UDP jitter for VoIP                             </li>
  <li>VoIP gatekeeper registration delay              </li>
  <li>VoIP post-dial delay                            </li>
</ul>
</p>
<p>
To view SLA operations that are supported by the local device, use the enable mode 
command <code><b>show ip sla application</b></code>. It is important that you 
run this command to verify that the SLA operation that you intend to configure 
is supported by the local device.
</p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code>
R1#<b>show ip sla application</b>                                        <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IP Service Level Agreements                                      <br>
Version: Round Trip Time MIB 2.2.0, Infrastructure Engine-III            <br>
                                                                         <br>
Supported Operation Types:                                               <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;icmpEcho, path-echo, path-jitter, udpEcho, tcpConnect, http      <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dns, udpJitter, dhcp, ftp, VoIP, rtp, lsp Group, icmpJitter      <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lspPing, lspTrace, 802.1agEcho VLAN, Port                        <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;802.1agJitter VLAN, Port, pseudowirePing, udpApp, wspApp         <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mcast, generic                                                   <br>
                                                                         <br>
Supported Features:                                                      <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPSLAs Event Publisher                                           <br>
                                                                         <br>
IP SLAs low memory water mark: 0                                         <br>
Estimated system max number of entries: 55324                            <br>
                                                                         <br>
Estimated number of configurable operations: 55324                       <br>
Number of Entries configured&nbsp;&nbsp;: 0                                        <br>
Number of active Entries&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: 0                                        <br>
Number of pending Entries&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: 0                                        <br>
Number of inactive Entries&nbsp;&nbsp;&nbsp;&nbsp;: 0                                        <br>
Time of last change in whole IP SLAs: *21:26:11.279 UTC Mon Mar 21 2022 
</code></div>

<h1>IP SLAs Operations</h1>
  <p>
  When configuring IP SLAs, the following are recommended best practices:
  <ul>
    <li><b>Time syncronization:</b> ensure that the source and responder devices 
    have the correct time. NTP can be configured on both devices to ensure that 
    the have the correct time.</li>
    <li><b>Configure the responder first:</b> for IP SLAs operations that require 
    specific configurations on the responder, complete the appropriate 
    configurations on the responder before making any configuration on the 
    source device.</li>
  </ul>
  </p>
 <p>
IP SLA operation consists of two devices: IP SLA source and responder.
 </p>
 <h2>IP SLAs Source</h2>
  <p>
  The IP SLAs source is the device where IP SLAs operations are configured. Probes 
  are sent to the responder by the source for the configured operation and the 
  different network performance parameters are analyzed after the responses are 
  received.
  </p>
  <h2>IP SLAs Responder</h2> 
  <p>
  The IP SLAs Responder is a component embedded in the destination Cisco routing 
  device that allows the system to anticipate and respond to IP SLAs request packets.
  </p>
  
  
  <h2>IP SLAs Control Protocol</h2>
  <p>
  The patented IP SLAs Control Protocol is used by the IP SLAs Responder providing
  a mechanism through which the responder can be notified by the source device 
  on which port it should listen and respond. Only a Cisco device can be a source for a destination IP SLAs 
  Responder.
   The IP SLAs Responder listens on a specific
   port for control protocol messages sent by an IP SLAs operation. Upon receipt 
   of the control message, the responder will enable the specified UDP or TCP 
   port for the specified duration. During this time, the responder accepts the 
   requests and responds to them. The responder disables the port after it 
   responds to the IP SLAs packet, or when the specified time expires. For added 
   security, MD5 authentication for control messages is available.
   </p>
   <p>
   Enabling the IP SLAs Responder on the destination device is not required for 
   all IP SLAs operations. For example, if services that are already provided by
   the destination device (such as Telnet or HTTP) are chosen, the IP SLAs 
   Responder need not be enabled. For non-Cisco devices, the IP SLAs Responder 
   cannot be configured and IP SLAs can send operational packets only to services 
   native to those devices.
  </p>
  <p>
  If you are using a Cisco IP SLAs Responder on the destination device for any auto IP SLAs operation,
  the responder must be enabled before you configure the IP SLAs operation. The following operations
  require that an IP SLAs responder be enabled on the destination device:
  <ul>
    <li>UDP Echo   </li>
    <li>UDP Jitter </li>
    <li>VoIP UDP   </li>
  </ul>
 </p>
 
 <h1>Configuration</h1>
 
<p>
Enabling IP SLAs operations consists of configuration of the responder, 
the SLA operation and its scheduling.

<h2>Device Availability and End-to-End Response Time</h2>

<h3>ICMP-echo Operations</h3>
<p>
The ICMP Echo operation is used to test reachability of a network device. It is 
also used to measure end-to-end response time between a Cisco router and any 
devices using IPv4 or IPv6. Response time is computed by measuring the time taken 
between sending an ICMP Echo request message to the destination and receiving an
ICMP Echo reply. ICMP Echo is useful for troubleshooting network connectivity issues.
</p>
<p>
In Cisco IOS, by default, when an ICMP Echo operation is run, only one packet is sent. 
The ICMP Echo operation does not require the configuration of a responder. The 
responder device can be any type of network device. To the responder, the ICMP-echo 
packet will appear as an ICMP request packet (ping). 
</p>
<h4>Step 1: Configure the IP SLAs Entry</h4>
<p>
The ICMP Echo operation is configured using the global configuration mode command 
<code><b>ip sla <i>operation-number</i></b></code>
</p>

<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code>
R1(config)#<b>ip sla 1</b>
</code></div>
<p>
IP SLAs entries cannot be modified once configured. You can only delete the 
entry and create a new one.
</p>
<h4>Step 2: Configure the ICMP Echo operation</h4>
<p>
Configure the ICMP Echo operation using the sla configuration mode command: 
<code><b>icmp-echo <i>destination-ip</i> source-ip <i>source-ip</i> | source-interface 
 <i>interface-name</i></b></code>. If the optional <code><b>source-ip</b></code> 
 or <code><b>source-interface</b></code> are not configured, then the source IP 
 address and exit interface will be selected based on the routing table entry 
 for the destination network or path to the default gateway.
</p>

<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code>
R1(config-ip-sla)#<b>icmp-echo 10.0.34.2</b>
</code></div>

<h4>Step 3: Configure the frequency</h4> 
<p>
The ICMP Echo frequency is in the range 1-604800 (seconds). If not configured, 
on some platforms, the default frequency is 60 seconds (one minute).
</p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code>
R1(config-ip-sla-echo)#<b>frequency 10</b>
</code></div>

<h4>Step 4: Schedule the IP SLA Operation</h4>
<p>
The IP SLAs is scheduled with the following command: <code><b>ip sla schedule 
<i>sla-entry-number</i> start-time <i>start-time</i> life <i>duration</i> 
recurring ageout <i>ageout</i></b></code>. The optional <code><b>recurring</b>
</code> keyword schedules the IP SLAs ICMP Echo operation to be run daily.
</p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code>
R1(config)#<b>ip sla schedule 1 start-time now life forever</b>
</code></div>

<h4>Verification</h4>
<h5><code>show ip sla statistics</code></h5>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code>
R1#<b>show ip sla statistics</b>                                      <br>
IPSLAs Latest Operation Statistics                             <br>
                                                               <br>
IPSLA operation id: 1                                          <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Latest RTT: 64 milliseconds                            <br>
Latest operation start time: 22:45:57 UTC Mon Mar 21 2022      <br>
Latest operation return code: OK                               <br>
Number of successes: 42                                        <br>
Number of failures: 0                                          <br>
Operation time to live: Forever                                <br>
</code></div>

<h5>show ip sla configuration</h5>

<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code>
R1#<b>show ip sla configuration</b>                                                <br>
IP SLAs Infrastructure Engine-III                                           <br>
Entry number: 1                                                             <br>
Owner:                                                                      <br>
Tag:                                                                        <br>
Operation timeout (milliseconds): 5000                                      <br>
Type of operation to perform: icmp-echo                                     <br>
Target address/Source address: 10.0.34.2/0.0.0.0                            <br>
Type Of Service parameter: 0x0                                              <br>
Request size (ARR data portion): 28                                         <br>
Verify data: No                                                             <br>
Vrf Name:                                                                   <br>
Schedule:                                                                   <br>
&nbsp;&nbsp;&nbsp;Operation frequency (seconds): 10  (not considered if randomly scheduled)<br>
&nbsp;&nbsp;&nbsp;Next Scheduled Start Time: Start Time already passed                     <br>
&nbsp;&nbsp;&nbsp;Group Scheduled : FALSE                                                  <br>
&nbsp;&nbsp;&nbsp;Randomly Scheduled : FALSE                                               <br>
&nbsp;&nbsp;&nbsp;Life (seconds): Forever                                                  <br>
&nbsp;&nbsp;&nbsp;Entry Ageout (seconds): never                                            <br>
&nbsp;&nbsp;&nbsp;Recurring (Starting Everyday): FALSE                                     <br>
&nbsp;&nbsp;&nbsp;Status of entry (SNMP RowStatus): Active                                 <br>
Threshold (milliseconds): 5000                                              <br>
Distribution Statistics:                                                    <br>
&nbsp;&nbsp;&nbsp;Number of statistic hours kept: 2                                        <br>
&nbsp;&nbsp;&nbsp;Number of statistic distribution buckets kept: 1                         <br>
&nbsp;&nbsp;&nbsp;Statistic distribution interval (milliseconds): 20                       <br>
Enhanced History:                                                           <br>
History Statistics:                                                         <br>
&nbsp;&nbsp;&nbsp;Number of history Lives kept: 0                                          <br>
&nbsp;&nbsp;&nbsp;Number of history Buckets kept: 15                                       <br>
&nbsp;&nbsp;&nbsp;History Filter Type: None
</code></div>
<p>
From the output above, the source address of 0.0.0.0 indicates that during 
configuration, the source IP address was not explicitly configured but it was 
determined based on the routing table exit interface to the destination.
</p>
<p>
The ICMP Echo processing is prone to some delays and may not accurately reflect 
characteristics of the network such as RTT. To extract more reliable and accurate
information on the network it is better to use UDP. 
</p>

<h2>IP SLAs UDP Echo Operation</h2>
  <p>
  UDP echo is used to measure response times and test end-to-end connectivity.
  Response time (round-trip time) is computed by measuring the time taken between
  sending a UDP echo request message from Device B to the destination device--
  Device A--and receiving a UDP echo reply from Device A. UDP echo accuracy is 
  enhanced by using the IP SLAs Responder at Device A, the destination Cisco 
  device. If the destination device is a Cisco device, then IP SLAs sends a UDP 
  datagram to any port number that you specified. Using the IP SLAs Responder is
  optional for a UDP echo operation when using Cisco devices. The IP SLAs 
  Responder cannot be configured on non-Cisco devices. The results of a UDP echo
  operation can be useful in troubleshooting issues with business-critical 
  applications by determining the round-trip delay times and testing connectivity.

  A responder should not configure a permanent port for a sender. If the 
  responder configures a permanent port for a sender, even if the packets are 
  successfully sent (no timeout or packet-loss issues), the jitter value is zero.
  </p>
  <h3>Step 1: (Optional) Configuration of Responder</h3>
    <p>
  In its most basic configuration, the reponder can be configured using the global 
  configuration command below:
  </p>
  <div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code>
  R4(config)#<b>ip sla responder</b>
</code></div>
<p>
  If the destination port number is not configured on the responder, a control packet will be 
  sent requesting the responder to expect packets arriving on a specific port.
  </p>
  <h3>Step 2: Configure the IP SLAs operation number</h3>
  <p>
  
  </p>
  <div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
   <code>
  R1(config)#ip sla 1
  </code></div>
  <h3>Step 3: Configure the UDP Echo operation</h3>
  <p>
  The UDP Echo operation can be configured using the command: <code><b>udp-echo
  <i>destination-ip destination-port</i> source-ip <i>source-ip</i> source-port 
  <i>port-number</i> control &lt;enable | disable&gt;</b></code>. 
  The source-ip and source-port are optional. The control keyword is optional. 
  It defines whether Cisco proprietary control packets are sent. If the responder 
  is a Cisco device and has been configured with the appropriate port number, 
  then control protocol may not be required to be sent.
  </p>
  <div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
   <code>
  R1(config-ip-sla)#<b>udp-echo 10.0.34.2 1962</b>
   </code></div>
   
   <p>
   With the above configuration, UDP control protocol packets are sent by the 
   source to the responder causing it to listen on the configured port. The 
   responder acknowledges with with a reply. Thereafter the UDP Echo packets 
   are then sent.
   </p>
   <p>
   The following output shows a Wireshark packet capture of IP SLAs control 
   packets and UDP Echo packets. 
   </p>
  <div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
   <code> 
   <b>
   No.	Time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Destination	Protocol	Length	Info </b><br>
   <span style="background-color:#a4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
32&nbsp;&nbsp;2022-03-22 05:49:23.207720&nbsp;&nbsp;10.0.12.1&nbsp;&nbsp;&nbsp;10.0.34.2&nbsp;&nbsp;&nbsp;UDP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;94&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;56422 &#8594; 1967 Len=52 <br>
33&nbsp;&nbsp;2022-03-22 05:49:23.250265&nbsp;&nbsp;10.0.34.2&nbsp;&nbsp;&nbsp;10.0.12.1&nbsp;&nbsp;&nbsp;UDP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;66&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1967 &#8594; 56422 Len=24 <br>
   </span>
34&nbsp;&nbsp;2022-03-22 05:49:23.260623&nbsp;&nbsp;10.0.12.1&nbsp;&nbsp;&nbsp;10.0.34.2&nbsp;&nbsp;&nbsp;UDP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;61186 &#8594; 1962 Len=16 <br>
35&nbsp;&nbsp;2022-03-22 05:49:23.315283&nbsp;&nbsp;10.0.34.2&nbsp;&nbsp;&nbsp;10.0.12.1&nbsp;&nbsp;&nbsp;UDP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1962 &#8594; 61186 Len=16 <br>
</code></div>
   
  <p>
  To disable control traffic at the source, append the <code><b>control disable 
  </b></code>keywords at the end of the UDP echo configuration command:
  <code><b>udp-echo 10.0.34.2 1962 control disable</b></code> 
  With control traffic disabled, the responder will not know which port to 
  open for the UDP packets. As a result, it will reply the UDP echo packet with destination port closed.
  To disable control traffic on the responder, configure the destination port as well.
  <code><b>ip sla responder udp-echo ipaddress <i>ip-address</i> port <i>port</i> vrf <i>vrf</i></b></code>
  The IP address and port number are optional.
  </p>
  <div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code>
  R4(config)#<b>ip sla responder udp-echo port 1967 </b>
</code></div>
  
<p>
For UDP Echo a Cisco networking device is recommended as the destination device 
although any networking device that supports RFC 862, Echo Protocol, can be used.
</p>
<h3>Verification</h3>
<h4><code>show ip sla statistics</code></h4>

<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
   <code> 
R1#<b>show ip sla statistics</b>                                <br>
IPSLAs Latest Operation Statistics                       <br>
                                                         <br>
IPSLA operation id: 1                                    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Latest RTT: NoConnection/Busy/Timeout            <br>
Latest operation start time: 06:02:02 UTC Tue Mar 22 2022<br>
<span style="background-color:#b4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
Latest operation return code: No connection </span>             <br>
Number of successes: 170                                 <br>
Number of failures: 2                                    <br>
Operation time to live: 1856 sec
</code></div>

<p>
  The output of show ip sla statistics, the return code result of "No connection" is an indication 
  that that the responder did not respond. During normal operation with an active 
  responder, the output of the command <code><b>show ip sla statistics</b></code>
  is shown below:
  </p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
   <code>  
  R1#<b>show ip sla statistics</b>                          <br>
IPSLAs Latest Operation Statistics                          <br>
                                                            <br>
IPSLA operation id: 1                                       <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Latest RTT: 65 milliseconds                         <br>
Latest operation start time: 05:33:42 UTC Tue Mar 22 2022   <br>
Latest operation return code: OK                            <br>
Number of successes: 3                                      <br>
Number of failures: 0                                       <br>
Operation time to live: 3574 sec
  </code></div>
  
<h4 style="font-size:12"><code>show ip sla responder</code></h4>
<p>
Displays configurations made on the responder. In the output below, the responder 
was configured with the basic command <code><b>ip sla responder</b></code>.
</p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
   <code> 
  R4#<b>show ip sla responder</b>                                 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;General IP SLA Responder on Control port 1967      <br>
General IP SLA Responder is: Enabled                       <br>
Number of control message received: 155 Number of errors: 0<br>
Recent sources:                                            <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.0.12.1 [05:58:22.147 UTC Tue Mar 22 2022]       <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.0.12.1 [05:58:12.155 UTC Tue Mar 22 2022]       <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.0.12.1 [05:58:02.143 UTC Tue Mar 22 2022]       <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.0.12.1 [05:57:52.135 UTC Tue Mar 22 2022]       <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.0.12.1 [05:57:42.131 UTC Tue Mar 22 2022]       <br>
Recent error sources:                                      <br>
                                                           <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Permanent Port IP SLA Responder
Permanent Port IP SLA Responder is: Disabled
</code></div>
<p>
The following output is of a responder that was configured with the command: 
<code><b>R4(config)#ip sla responder udp-echo port 1967</b></code>.
</p>

<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
   <code> 
R4(config)#<b>do show ip sla responder</b>                  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;General IP SLA Responder on Control port 1967       <br>
General IP SLA Responder is: Enabled                        <br>
Number of control message received: 210 Number of errors: 0 <br>
Recent sources:                                             <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.0.12.1 [06:17:22.159 UTC Tue Mar 22 2022]        <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.0.12.1 [06:17:12.155 UTC Tue Mar 22 2022]        <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.0.12.1 [06:17:02.147 UTC Tue Mar 22 2022]        <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.0.12.1 [06:16:52.151 UTC Tue Mar 22 2022]        <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.0.12.1 [06:16:42.143 UTC Tue Mar 22 2022]        <br>
Recent error sources:                                       <br>
                                                            <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Permanent Port IP SLA Responder                     <br>
Permanent Port IP SLA Responder is: Enabled                 <br>
                                                            <br>
udpEcho Responder:                                          <br>
&nbsp;&nbsp;IP Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port                               <br>
&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1967                               <br>
&nbsp;&nbsp;::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1967
</code></div>

<h4><code>show ip sla configuration</code></h4>



 <h2>IP SLA ICMP Path Echo Operations</h2>
 <p>
 ICMP path-echo operation is used to monitor end-to-end and hop-by-hop response 
 time between a Cisco device and other devices using IP. ICMP Path Echo is useful 
 for determining network availability and for troubleshooting network connectivity 
 issues.
 The IP SLAs ICMP Path Echo operation records statistics for each hop along the 
 path that the IP SLAs operation takes to reach its destination. The ICMP Path 
 Echo operation determines this hop-by-hop response time between a Cisco device 
 and any IP device on the network by discovering the path using the traceroute
facility. The results of the ICMP Path Echo operation can be displayed and 
analyzed to determine how ICMP is performing.
 </p>
 <p>
 Using the statistics recorded for the response times and availability, the ICMP 
 Path Echo operation can identify a hop in the path that is causing a bottleneck.
 </p>
 <p>
 This operation does not require an IP SLAs Responder on the destination device. 
 </p>
 <p>
 To configure an IP SLAs ICMP Path Echo operation, the IP SLAs mode command 
 <code><b> path-echo <i>destination-ip-address | destination-hostname</i> 
 source-ip <i> ip-address | hostname</i>
 </b></code>
 </p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
   <code>
R1(config)#<b>ip sla 1</b><br>
R1(config-ip-sla)#<b>path-echo 10.0.34.2</b><br>
R1(config-ip-sla-path-echo)#<b>frequency 10</b><br>
R1(config-ip-sla-path-echo)#<b>exit</b><br>
R1(config)#<b>ip sla schedule 1 start-time now</b><br>
</code></div>

<h3>Verification</h3>
<h5><code>show ip sla statistics</code></h5>
<p>

</p>

<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
   <code>
R1#<b>show ip sla statistics</b>                           <br>
IPSLAs Latest Operation Statistics                         <br>
                                                           <br>
IPSLA operation id: 1                                      <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Latest RTT: 62 milliseconds                        <br>
Latest operation start time: 05:19:33 UTC Tue Mar 22 2022  <br>
Latest operation return code: OK                           <br>
Number of successes: 20                                    <br>
Number of failures: 0                                      <br>
Operation time to live: 3406 sec
</code></div>

<h2>IP SLAs UDP Jitter Operation</h2>
<p>
The IP Service Level Agreements (SLAs) UDP jitter operation diagnoses network 
suitability for real-time traffic applications such as VoIP, video over IP, or 
real-time conferencing. IP SLAs analyzes round-trip delay, one-way delay, one-way
jitter, one-way packet loss, and connectivity in networks that carry UDP traffic
in IPv4 or IPv6 networks.

Jitter means inter-packet delay variance.
</p>
<p>

However, the IP SLAs UDP jitter operation does more than just monitor jitter. 
As the UDP jitter operation includes data returned by the IP SLAs UDP operation, 
the UDP jitter operation can be used as a multipurpose data gathering operation. 
The packets that IP SLAs generate carry packet-sending and receiving sequence
information, and sending and receiving time stamps from the source and the 
operational target. Based on this information, UDP jitter operations are capable
of measuring the following:
<ul>
  <li>Per-direction jitter (source to destination and destination to source)</li>
  <li>Per-direction packet loss</li>
  <li>Per-direction delay (one-way delay)</li>
  <li>Round-trip delay (average round-trip time)</li>
</ul>
As paths for sending and receiving data may be different (asymmetric), the 
per-direction data allows you to more readily identify where congestion or other 
problems are occurring in the network.
The UDP jitter operation functions by generating synthetic (simulated) UDP traffic.
Asymmetric probes support custom-defined packet sizes per direction with which 
different packet sizes can be sent in request packets (from the source device to
the destination device) and in response packets (from the destination device to 
the source device).
</p>
<p>
When compared to the IP SLAs UDP jitter operation, the IP SLAs ICMP jitter 
operation may provide less accurate measurements because the accuracy of the 
measurements provided by a non-Cisco destination device cannot be determined.
</p>
<p>
The UDP jitter operation sends N number of UDP packets, each of size S, T milliseconds apart, from a source
device to a destination device, at a given frequency of F. In response, UDP packets of size P is sent from the
destination device to the source device. By default, ten packet frames (N), each with a payload size of 10
bytes (S), are generated every 10 ms (T), and the operation is repeated every 60 seconds (F). Each of these
parameters is user-configurable, so as to best simulate the IP service that you provide, as shown in the table
below.
</p>
<table cellspacing="0">
<caption>UDP Jitter Operation Parameters</caption>
<thead style="font-weight:bold;">
<tr>
    <td style="border-bottom: 1px solid;">UDP Jitter Operation Parameter</td>
    <td width="35%" style="border-bottom: 1px solid;"> Default </td>
    <td style="border-bottom: 1px solid;"> Configuration Commands </td>
  </tr>
</thead>
<tbody>
  <tr>
    <td style="border-bottom: 1px solid;">Number of packets (N)  </td>
    <td style="border-bottom: 1px solid;">10 packets </td>
    <td style="border-bottom: 1px solid;">udp-jitter num-packets </td>
  </tr>
    <tr>
    <td style="border-bottom: 1px solid;"> Payload size per request packet (S)</td>
    <td style="border-bottom: 1px solid;"> 10 bytes </td>
    <td style="border-bottom: 1px solid;">request-data-size </td>
  </tr>
    <tr>
    <td style="border-bottom: 1px solid;">Payload size per response packet
(P) </td>
    <td style="border-bottom: 1px solid;">
The default response data size 
varies depending on the type of IP
SLAs operation configured.
Note: If the response-data-size
command is not
configured, then the
response data size value
is the same as the request
data size value. </td>
    <td style="border-bottom: 1px solid;">response-data-size </td>
  </tr>
    <tr>
    <td style="border-bottom: 1px solid;">Time between packets, in milliseconds (T)</td>
    <td style="border-bottom: 1px solid;">10 ms  </td>
    <td style="border-bottom: 1px solid;">udp-jitter interval </td>
  </tr>
    <tr>
    <td style="border-bottom: 1px solid;"> Elapsed time before the operation</td>
    <td style="border-bottom: 1px solid;">  60 seconds</td>
    <td style="border-bottom: 1px solid;"> frequency (IP SLA) </td>
  </tr>
   
</tbody>
</table>


<h3>Step 1: (Optional) Configure the Responder</h3>
<p>
To configure the responder and eliminate control protocol message exchange use 
the command <code><b>ip sla responder udp-echo ipaddress <i>ip-address</i> port 
<i>port</i> vrf <i>vrf</i> </b></code>
</p>
  <div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
   <code>
    R4(config)#<b>ip sla responder udp-echo port 20000</b>
   </code></div>

<h3>Step 2: Configure UDP-Jitter parameters</h3>

<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
   <code>
R1(config)#<b>ip sla 1</b>                                           <br>
R1(config-ip-sla)#<b>udp-jitter 10.0.34.2 20000 control disable</b>  <br>
R1(config-ip-sla-jitter)#<b>frequency 10</b>                         <br>
</code></div>

<p>
Additional configurations usually include the maintenance of history data for the 
SLA.
</p>


<h3>Step 3: Schedule the IP SLAs UDP Jitter Operation</h3>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
   <code>
   R1(config)#<b>ip sla schedule 1 start-time now</b>

   </code></div>

<h2>ICMP Path Jitter</h2>
<p>
Internet Control Message Protocol (ICMP) Path Jitter operation to monitor 
hop-by-hop jitter (inter-packet delay variance).

IP SLAs - ICMP Path Jitter provides hop-by-hop jitter, packet loss, and delay measurement statistics in an IP
network. Path jitter operations function differently than the standard UDP Jitter operation, which provides
total one-way data and total round-trip data.
</p>
<p>
An ICMP Path Jitter operation can be used a supplement to the standard UDP Jitter operation. For example,
results from a UDP Jitter operation may indicate unexpected delays or high jitter values; an ICMP Path Jitter
operation could then be used to troubleshoot the network path and determine if traffic is bottlenecking in a
particular segment along the transmission path.
</p>
<p>
The operation first discovers the hop-by-hop IP route from the source to the destination using a traceroute
utility, and then uses ICMP echoes to determine the response times, packet loss and approximate jitter values
for each hop along the path. The jitter values obtained using IP SLAs - ICMP Path Jitter are approximates
because ICMP only provides round trip times.
</p>
<p>
ICMP Path Jitter operations function by tracing the IP path from a source device to a specified destination
device, then sending N number of Echo probes to each hop along the traced path, with a time interval of T
milliseconds between each Echo probe.
</p>
</p>

<h4>Configuring SLA Responder</h4>
ip sla responder
<h4>Configuration</h4>
<p>
path-jitter <i>destination-ip</i>
</p>

<h4>ICMP Path Jitter Restrictions</h4>
<p>
  <ul>
    <li>IP SLAs - ICMP Path Jitter is ICMP-based. ICMP-based operations can compensate for source processing
delay but cannot compensate for target processing delay. For more robust monitoring and verifying, we
recommend that you use the IP SLAs UDP Jitter operation.</li>
 <li>The jitter values obtained using IP SLAs - ICMP Path Jitter are approximates because ICMP does not
provide the capability to embed processing times on devices in the packet. If the target device does not
place ICMP packets as the highest priority, then the device will not respond properly. ICMP performance
also can be affected by the configuration of priority queueing on the device and by ping response.</li>
<li>A path jitter operation does not support hourly statistics and hop information.
 <li>Unlike other IP SLAs operations, the ICMP Path Jitter operation is not supported in the RTTMON MIB.
Path jitter operations can only be configured using Cisco commands and statistics can only be returned
using the show ip sla commands.</li>
 <li>IP SLAs - Path Jitter does not support the IP SLAs History feature (statistics history buckets) because
of the large data volume involved with jitter operations.</li>
  </ul>
</p>

<h4>Responder</h4>
<p>
Enter one of the following commands:
• ip sla responder
• ip sla responder udp-echo ipaddress ip-address port portvrf vrf
</p>
<p>
A responder should not configure a permanent port for a sender. If the responder configures a permanent
port for a sender, even if the packets are successfully sent (no timeout or packet-loss issues), the jitter
value is zero. (Optional; required only if protocol control is disabled on the
source.) Enables IP SLAs responder functionality on the
specified IP address, port and VRF. • Protocol control is enabled by default.
</p>

<p>
The delay and jitter in a path can be measured using the SLA command <code><b>
udp-jitter <i>destination-ip port</i> source-ip <i>source-ip</i> num-packets <i>
num-packets</i> interval <i>interval</i> </b></code>
By default, if not configured, the interval delay value is 20, the number of 
packets is 10 
</p>
<p>
UDP jitter command requires the configuration of the SLA responder.
<code><b>ip sla responder</b></code>. This command makes the local device a 
responder to any SLA command that requires a responder to be explicitly 
configured.
Multiple SLA probes configured with same source and destination IP and port number must not be run
simultaneously.
</p>
<h3>Verification</h3>
<h4><code>show ip sla statistics</code></h4>
<p>
</p>
<h4><code>show ip sla responder</code></h4>
<p>

</p>
<h4><code>show ip sla configuration</code></h4>
<p>

</p>


<h3>DHCP SLA</h3>
<p>
The DHCP operation measures the round-trip time (RTT) taken to discover a
DHCP server and obtain a leased IP address from it. IP SLAs releases the leased IP address after the operation.
You can use the RTT information to determine DHCP performance levels.
IP SLAs.
</p>
<p>
There are two modes for the DHCP operation. By default, the DHCP operation sends discovery packets on
every available IP interface on the device. If a specific server is configured on the device, discovery packets
are sent only to the specified DHCP server.
</p>
<p>
The functionality of a DHCP server can be tested using the command <code><b>
dhcp <i>dhcp-server-ip</i> </b></code>. When configuring the DHCP SLA frequency,
the mininum frequency is set to 10 seconds. The source device will send a DHCP 
request to the DHCP server. After the DORA process is completed, the DHCP SLA 
operation will release the IP address issued by the DHCP server which will in 
turn return the address to the DHCP pool.
</p>
<h4>Verification</h4>
<h5><code>show ip sla statistics</code></h5>
<h5><code>show ip sla application</code></h5>
<p>
Displays active SLA operations.
</p>

<h5><code>show ip dhcp binding</code></h5>
<p>
Displays IP addresses issued and the associated MAC/client ID.
</p>

<h3>DNS Operations</h3>
<p>
The DNS operation measures the difference between the time taken to send a DNS 
request and receive a reply. 
The resulting DNS lookup time can help you
analyze your DNS performance. Faster DNS lookup times translate to a faster web server access experience
<code><b> dns <i>destination-ip</i> name-server <i>ip-address</i> </b></code>
</p>

<h1>Tracking Object</h1>
<p>
Object Tracking lets you dynamically control what occurs if the result of the 
tracking object is up or down. For example, you can attach an object to a static
route; if the object is up, the route is installed in the routing table. If the 
object is down, the route is not installed in the routing table. You can track 
IP routes, IP SLA instances, interfaces, and groups of objects. 
To verify the configuration of a tracking object and the status of the tracking 
object, use the show track command. In Example 23-26, tracking object 1 exists 
on SW1. It is tracking the reachability of an IP route, 10.1.43.0/24. If the 
route is in the routing table, the object is up. If the route is not in the routing 
table, the object is down. The object is attached to HSRP Group 10, as shown 
after Tracked by: in the output.
</p>



<p>
is used to apply the IP SLA to whatever requires is function for example, a static route.
To create a track
define the track and the track number. The track number does not have to match the IP SLA operation 
number but it makes it easier for troubleshooting if the two match.
</p>
<p>
track 100 ip sla state
delay up 1
delay down 0
</p>
<p>
To apply the track to a static route, first configure the static route without the track, then
configure the same static route with the track. Thirdly delete the static route without the track:
<code><b>ip route 10.0.0.2 255.255.255.0 192.168.12.2 track 100</b></code>. The static route 
will change state depending on the status of the tracked object.
</p>
<h3>Verification</h3>
<code><b>show track</b></code>
Displays the sla being tracked.
The state of the operation i.e. whether up or down


<h3>Verification</h3>
<h4><code>show ip sla responder</code></h4>


<h1>Configuration of IP SLA Operation</h1>
 
<h2>Step 1: Define the Operation</h2>
<p>
<ol>
  <li>Define the operation using the command <code><b>ip sla 1</b></code></li>
  <li>the type of operation: <code><b>icmp-echo <i>destination-ip</i> 
  &lt;source-interface&gt; <i>interface-name</i></b></code></li>
  <li>Indicate the frequency of occurrence. <code><b>frequency <i>number</i>
  </b></code></li>
</ol>
</p>
<h2>Schedule</h2>
<p>
Default life of the probe is 3600 seconds or one hour. 
</p>
<p>
  <code><b>ip sla schedule 1 start-time now life forever</b></code>
</p>
<h1>Verification</h1>
<h2><code>show ip sla statistics</code></h2>
<p>
<ul>
<li>Displays all IP SLA operation numbers.</li>
<li>Latest operation start time.</li>
<li>Latest operation return code.</li> 
<li>Operation life time.</li>
</ul>
</p>
<h2><code>show ip sla summary</code></h2>
<p>
<ul>
 <li>shows that the IP SLA is active.</li>
 <li>shows that round trip time of the operation.</li>
 <li>shows if the operation was successful.<li>
 <li>shows the type of operation i.e. whether ICMP-echo.</li>
</ul>
</p>
<h2><code>show ip sla configuration</code></h2>
<p>
Displays show the IP SLA operation was configured.
<ul>
  <li>Shows the IP SLA operation number.</li>
  <li>Operation time out</li>
  <li>Source address and destination address. A source address of 0.0.0. implies that 
  the source address is determined at run time.</li>
  <li>Configured VRF.</li>
   
</ul>
</p>
<h1>Troubleshooting IP SLA</h1>
<p>
When troubleshooting Cisco IOS IP SLA, consider the following:
Choose the correct operation for the metrics you intend to measure.
Ensure that the destination IP address is reachable and correctly defined.
Ensure that the source IP address is reachable from the destination and correctly defined.
Ensure that any necessary port numbers are correctly identified.
The SLA instance needs to be started.
If the operation needs an IP SLA responder, one must be configured and reachable.
</p>
<h2>ICMP Path-echo</h2>
<p>
  <ul>
    <li>If the IP Service Level Agreements (SLAs) operation is not running and not generating statistics, add
the verify-data command to the configuration (while configuring in IP SLA configuration mode) to
enable data verification. When data verification is enabled, each operation response is checked for
corruption. Use the verify-data command with caution during normal operations because it generates
unnecessary overhead.</li>
 <li> Use the debug ip sla trace and debug ip sla error commands to help troubleshoot issues with an IP
SLAs operation.</li>
  </ul>
</p>
<h2>ICMP Path-jitter</h2>
<p>
<ul>
  <li>
If the IP Service Level Agreements (SLAs) operation is not running and not generating statistics, add
the verify-data command to the configuration (while configuring in IP SLA configuration mode) to
enable data verification. When data verification is enabled, each operation response is checked for
corruption. Use the verify-data command with caution during normal operations because it generates
unnecessary overhead. </li>
<li>
• Use the debug ip sla trace and debug ip sla error commands to help troubleshoot issues with an IP
SLAs operation.</li>
</ul>
</p>

<h2>DHCP</h2>
<ul>
  <li>
  If the IP Service Level Agreements (SLAs) operation is not running and not generating statistics, add
the verify-data command to the configuration (while configuring in IP SLA configuration mode) to
enable data verification. When data verification is enabled, each operation response is checked for
corruption. Use the verify-data command with caution during normal operations because it generates
unnecessary overhead.</li>
<li>
• Use the debug ip sla trace and debug ip sla error commands to help troubleshoot issues with an IP
SLAs operation.
  </li>
</ul>

<h2>DNS Operations</h2>
<p>
  <ul>
    <li>If the IP Service Level Agreements (SLAs) operation is not running and not generating statistics, add
the verify-data command to the configuration (while configuring in IP SLA configuration mode) to
enable data verification. When data verification is enabled, each operation response is checked for
corruption. Use the verify-data command with caution during normal operations because it generates
unnecessary overhead. </li>
<li>
• Use the debug ip sla trace and debug ip sla error commands to help troubleshoot issues with an IP
SLAs operation.</li>
  </ul>
</p>

<h2>UDP Jitter Operations</h2>
<p>
  <ul>
     <li>If the IP Service Level Agreements (SLAs) operation is not running and not generating statistics, add
the verify-data command to the configuration (while configuring in IP SLA configuration mode) to
enable data verification. When data verification is enabled, each operation response is checked for
corruption. Use the verify-data command with caution during normal operations because it generates
unnecessary overhead.</li>
    <li>Use the debug ip sla trace and debug ip sla error commands to help troubleshoot issues with an IP
SLAs operation.</li>
  </ul>
</p>