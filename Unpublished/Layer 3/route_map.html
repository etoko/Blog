<h1>Route-maps</h1>
<p>
Route-maps provide If/Then/Else logic like in programming languages. 
Route-maps are very flexible in matching prefixes. 
A single route-map has several route-map commands with the same text name.
Route-map also has the concept of using sequence numbers. When a route is matched
by a route-map entry either as a permit or deny, the IOS stops processing the 
route-map for that route, even when ethere are more entries in the route-map.
</p>
<p>
A route-map can call an ACL or prefix-list. ACLs or prefix lists match the routes. 
The route-map tells what to do with the matched routes: permit or deny. 
</p>
<p>
A single route-mmap contains one or more route-map commands (entries). Each route-map 
entry has underlying matching parameters, configured with the <code><b>match</b></code>
command.
</p>
<h1>Using Route-maps</h1>
<p>
When configuring a route-map, the first action should be a match statement.
Route-maps use the following 
features to match routes:
<ul>
  <li>Access control lists</li>
  <li>Prefix-lists</li>
  <li>Route-type</li>
  <li>Metric, metric type</li>
  <li>Next hop</li>
  <li>BGP attributes</li>
</ul>
</p>
<p>
Actions consist of permit or deny. 
If a route-map references an ACL or prefix-list, the ACL and prefix-list permit 
statement means match this prefix. the deny statement means do not match the 
prefix.

Route-maps have an explicity deny statement.
Route-maps support modifying prefix attributes. This is heavily utilized in BGP.
</p>
<p>
Sequential, first-match processing:
Unless otherwise, configured using "continue"
Used in advanced cases when logical "and" processing is needed.
</p>
<p>
Use of route-maps makes it possible to use more than one prefix-list for filtering
while if using a prefix-list directly for route-filtering, only one prefix-list 
can be used per interface.

Task 1: Permit /24 to /27 from 192.168.0.0/16

ip prefix-list PL1 permit 192.168.0.0/16 ge 24 le 27

route-map RM1 permit 10
  match ip address prefix-list PL1
</p>
<p>
Deny /24 to /27 from 192.168.0.0/16 if routes are internal. Allow external routes 
from the same range:
<code><b>
ip prefox-list PL1 permit 192.168.0.0/16 ge 24 le 27
route-map RM2 deny 10
  match ip address prefix-list PL1
  match route-type internal
route-map RM2 permit 20
  match ip address prefix-list PL1
  match route-type external
</b></code>
</p>


<h2>Sequence numbers</h2>
<p>
Route-maps give the first statement a sequence number of 10. Route-maps do not 
automatically increment the sequence number like ACLs. If no sequence number is 
entered, subsequent statements overwrite the first statement. 
</p>
<p>

</p>
<h1>Matching</h1>
<p>
ACLs or prefix-lists match the routes. The route-map tells what to do with the 
matched routes using permit or deny. A deny or permit action in the ACL or 
prefix list does not mean that the route is being filtered.

</p>
<p>
A route-map without the match statement is equivalent to match any.
</p>

<p>
When processing a route-map, the processing starts at the top with the lowest 
sequence number and progress sequentially. The first successful match ends 
the execution of the prefix-list except if the continue statement is used.
A deny statement in the ACL/Prefix list that is referenced by a permit statement 
in the RM results in no match and execution of the RM moves to the next RM 
sequence number.
</p>

<h1>Verification</h1>
<p>

</p>