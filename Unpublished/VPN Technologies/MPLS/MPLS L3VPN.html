 <h1>Configuring MPLS Layer 3 VPN on Cisco IOS</h1>
 
 <p>
   <ol>
     <li><a href="#INTRODUCTION">Introduction</a></li>
     <li><a href="#COMPONENTS">L3VPN Components</a></li>
     <li><a href="#CONFIGURATION">Configuration</a></li>
     <li><a href="#TROUBLESHOOTING">Troubleshooting</a></li>
     
     
   </ol>
 </p>
 
<h1 id="INTRODUCTION">Introduction and Overview</h1>
<p>
MPLS Layer 3 VPNs (L3VPNs) are used by service providers (SPs) to provide layer 3   
connectivity between an enterprise and its different remote offices/locations 
through the service provider's network. MPLS L3VPNs are defined by RFC 4364. 

SPs are able to provide different customers layer 3 connectivity to their remote 
locations using the same underlaying infrastructure. This is possible regardless of 
whether the different customer sites use the same overlapping RFC 1918 IP 
addresses or not. 
Traffic from different customers is differentiated using VPNv4 addresses and routed 
to their respective destinations using the SP's core network.
</p>
<p>
The following topology will be used to configure MPLS Layer 3 VPNs.
<img alt="" src="Media/l3vpn_topology.png">

</p>
<p>
The routers R1, R5, and R6 in the topology above are referred to as Provider Edge (PE) 
routers or edge Label Switch Routers (LSR). The MPLS network is usually referred 
to as the P network and the customer network, the C network. All LSRs in the P 
network have MPLS configured. PE routers have VRFs for each customer. Customer 
Edge (CE) routers have no knowledge of MPLS or VRFs. CE routers connect to Provider
Edge (PE) routers.
</p>
<p>
At the PE routers, VRFs are created for each customer as one PE router may 
connect to many CE routers. Each customer’s routes will be separated from other 
customers in their own routing table.
</p>

<h1 id="COMPONENTS">MPLS L3VPN Components</h1>
<p>
MPLS L3VPNs consist of prefix exchange between CE and PE and P routers in the 
service provider's core network.

 <h2>Service Provider Core</h2>
 <p>
In the service provider core of an MPLS L3VPN, the P routers run MPLS over an 
 interior gateway protocol(IGP) such as IS-IS, OSPF; the result is that packets are switched using 
 MPLS along routing paths created by the underlaying IGP. Intermediate LSRs in 
 the provider core network do not have the customer  prefixes in their routing tables.
 All P routers (intermediate and edge LSRs) run an IGP and are configured for MPLS. LDP 
 is usually configured as the label exchange protocol. Other labeling methods 
 are supported such as BGP, RSVP-TE, etc.
 </p>
 
 <h3>PE Routers</h3>
 <p>
 For purposes of providing MPLS L3VPN services, only PE routers run BGP and they 
 form an iBGP peering through the VPNv4 address family.
	On the PE, a VRF is created for each customer. This ensures that each 
 customer has their prefixes in a separate routing table. 
	In the VRF configuration, a route distinguisher (RD) is configured. This 
	is used by MP-BGP on the PE to differentiate the customer's prefixes 
 (including overlapping IP addresses) when switching customer traffic through 
 the provider core network.
	The PE interface connecting to each customer's CE is placed in its corresponding VRF.
	Additionally, the route-target (RT) is configured on the PE devices to 
	determine into which VRF routing table a prefix should be placed.
</p>

<h3>Route Distinguisher (RD)</h3>
<p>
The Route Distinguisher (RD) is a 64-bit (8-byte) value usually of the format ASN:nn or 
IP address:nn where ASN is the Autonomous system number and nn is any random 
number. RD is used by the PE to distinguish and uniquely identify the different 
VRFs; to differentiate the multiple prefixes from different customers.
This allows for overlapping IPv4 addresses between customers.
It is locally significant and does not need to match on the remote PE. This is 
very critical particularly when clients are using RFC 1918 prefixes. 
</p>

<h3>VPNv4</h3>
<p>
The RD is used to create <b>VPNv4 addresses</b>. This is a <b>96-bit</b> value that consists 
of the RD (64-bit) and the IP address/network address (32-bit). It is usually in 
the format RD:IP address. An example can be 65000:10000:10.10.20.0 where the 
value 65000:10000 is the RD and 10.10.20.0 is the prefix being shared. VPNv4 
addresses make addresses from the different customers unique. This results in the 
ability of the SP to route traffic for different customers regardless of whether 
they use overlapping address space or not.

VPNv4 NLRI main attributes include:
<ul>
  <li>8-byte route distinguisher(RD)</li>
  <li>IPv4 prefix and length</li>
  <li>Next hop</li>
  <li>MPLS VPN label</li>
</ul>
</p>


<h3>MPLS Layer 3 VPN Label Stack</h3>
<p>
L3VPN needs at least 2 labels to forward traffic across an MPLS L3VPN. 
The first label attached is the VPN label and the second is the transport/Label 
Distribution Protocol (LDP) label. 
On an MPLS packet, the transport label is the top most label. It is typically 
derived from LDP. It is sometimes referred to as the IGP label. 
The LDP label(transport label) is used for label switching from PE to PE through the MPLS domain 
as intermediate LSRs run only MPLS and not BGP. The transport label basically 
tells SP MPLS core LSRs which PE traffic is destined to i.e., which 
PE device is the exit point out of the L3VPN to the CE. The VPN Label is derived from VPNv4 advertisements of PE and 
 is used by the PE router to determine which CE traffic is destined to.
 </p>
 <p>
The VPN label is used by the egress LSR/PE router to determine customer specifics 
about the packet and what to do with it. The VPN label tells the PE router which 
CE traffic is destined to. It is derived from VPNv4 advertisements of PEs.
Other applications such as MPLS TE, FRR, etc., require even more labels.
VPN labels are exchange between PE routers over the MP-BGP peering. Labeled 
packets are advertised along with BGP extended communities path attributes.
MPLS generates labels for VPNv4 routes and adds [V] after the prefix to indicate 
that the label is a VPNv4 label.
In the L3VPN label stack, the VPN label is usually at the bottom of the stack 
(nearest to the Layer 3 header) as indicated by the 1-value is the S-section of 
the MPLS header.
</p>


<h3>Route Target (RT)</h3>
<p>
A route-target (RT) is a 64-bit value similar in format to the RD i.e. ASN:nn or 
IP addess:nn. It is used by MP-BGP to determine the VRF into which the different 
customer prefixes should be installed. RT is defined by RFC 4360 (BGP extended communities attribute).

The routes defined in the VRF of one customer are tagged for export 
to the remote PE customer VRF using the command 
<code style="font-size:120%;"><b>route-target export ASN:nn</b></code>. To 
import these routes into the appropriate VRF at the remote PE router, the command 
<code style="font-size:120%;"><b>route-target import ASN:nn</b></code> is used.
The new BGP extended community attribute "route-target" is used to control what 
prefixes enter and exit the VRF table.
<ul>
  <li><b>export route target:</b> what routes will go from VRF into BGP.</li>
  <li><b>import route target:</b> what routes will go from BGP into VRF.</li>
</ul>
The RT allows for granular control over what sites have what routes. 
</p>
<p>
As an alternative to the use of RD, the route-maps "import map" and "export map" 
allow control over import and export on a per prefix basis.
</p>

<p>
RT controls the route’s VPN VRF membership(s). It is possible to have multiple 
RTs per VPNv4 route but one RD per VPNv4 route. VPNv4 speakers only accept VPNv4 
routes with an RT matching a local VRF. Some exceptions include route reflectors. 
VPNv4 routes can have more than one RT. This allows for complex VPN topologies 
such as full mesh, hub and spoke, central services.
The RT value used for export in the VRF on the ingress PE router should be the 
same RT value used in the RT-import of the appropriate VRF on the remote egress PE.
</p>
  
  <h2>PE-CE</h2> 
<p>
The CE forms an IGP peer relationship with the PE. Through this peering, it 
exchanges its prefixes with the PE. The PE isolates these prefixes received from 
the CE into the VRF created for this customer. For ingress traffic, the PE 
redistributes these customer prefixes from the IGP VRF table into MP-BGP VRF for 
that customer. This configuration is implemented using the corresponding BGP VRF address-family.
For egress traffic, the prefixes are redistributed from MP-BGP VRF into the IGP.
    </p>
<p>If the PE and CE routers have an eBGP peering, the prefixes are exchanged using 
BGP and no IGP (and redistribution) is required. MPLS is not configured on 
any client facing interfaces. Network traffic at the CE-PE interface uses normal 
IPv4 or IPv6 routing and all IPv4 protocols supported. Some IPv6 protocols 
supported.
   </p>
  
<h1 id="CONFIGURATION">Configuration</h1>
<p>
To create L3VPNs, the following steps should be taken.
<ul>
<li>Step 1: Ensure MPLS infrastructure is in place. i.e. IP routing, MPLS.</li>
<li>Step 2: Create the VRFs on the PE/edge LSR and interfaces connecting to each customer device should 
be configured to be in the appropriate VRF.</li>
<li>Step 3: Configure iBGP peering between the PE routers using VPNv4 address-family.</li>
<li>Step 4: Enable IGP peering and route exchange between the PE and CE devices.</li>
<li>Step 5: Redistribute routes between MP-BGP VRF address-family and PE-CE 
routing protocol (this is not needed if PE-CE routing uses eBGP).</li>
<li>Step 6: Test connectivity.</li>
</ul>
</p>

<h2>Step 1: Ensure MPLS Infrastructure is in Place</h2>
<p>
When configuring MP-BGP on an LSR, ensure that BGP peer address and the MPLS 
LDP ID match for ease of configuration.
 
Guidance on how to configure an operational MPLS infrastructure can be found 
<a href="https://emmanueltoko.blogspot.com/2021/02/configuring-mpls-in-cisco-ios.html" target="_blank">here</a>.
</p>

<h2>Step 2: Create VRFs on PE Routers</h2>
<p>
Virtual Routing and Forwarding (VRFs) are used to create separate routing tables 
for each customer on a router. These routing tables are separated from the 
global routing table (RIB). The RT and RD are then configured under each VRF.

There are two ways to create a VRF; 
<ol>
  <li><code style="font-size:120%;"><b>ip vrf &lt;vrf-name&gt;</b></code> (older method).
   <p>
   This command creates VRFs that for the IPv4 address family only.
   </p>
  <p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
R1(config)#<b>ip vrf CUST_X_HQ</b>                       <br>
R1(config-vrf)#<b>rd 300:100                  </b> <br>
R1(config-vrf)#<b>route-target export 300:100 </b> <br>
R1(config-vrf)#<b>route-target import 300:110 </b> <br>
R1(config-vrf)#<b>ip vrf CUST_Z_2                  </b> <br>
R1(config-vrf)#<b>rd 200:2                  </b> <br>
R1(config-vrf)#<b>route-target export 200:110 </b> <br>
R1(config-vrf)#<b>route-target import 200:100 </b> <br>
</code></div>
</p>

  <p>
Two VRFs CUST_X_HQ and CUST_Z_2 have been created.
</p>
  
  </li> 
  <li> <code style="font-size:120%;"><b>vrf definition &lt;vrf_name&gt;</b></code>.
  <p>
  <div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
R6(config)#<b>vrf definition CUST_Z_HQ           </b> <br>
R6(config-vrf)#<b>rd 200:1                      </b> <br>
R6(config-vrf)#<b>address-family ipv4                </b> <br>
R6(config-vrf-af)#<b>route-target export 200:100  </b> <br>
R6(config-vrf-af)#<b>route-target import 200:110  </b> <br>
</code></div>
</p>
<p>
The VRF created is CUST_Z_HQ. VRF names do not need to match as they are locally 
significant.
</p>
  </li>
  </ol>
</p>

<h3><code style="font-size:120%;">vrf upgrade-cli</code></h3>
<p>
The global configuration command <code style="font-size:120%;"><b>vrf upgrade-cli</b></code> 
is an important command to 
use particularly when introducing VRFs in IPv6 in a network where IPv4 VRFs are 
operational. It has been previously mentioned that the <code style="font-size:120%;"><b>
vrf definition &lt;vrf-name&gt;</b></code> command supports creation IPv6 VRFs. 
If the VRFs were created like in following configuration;
</p>
<p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
R1(config)#<b>ip vrf CUST_X_HQ</b>                       <br>
R1(config-vrf)#<b>rd 300:100                  </b> <br>
R1(config-vrf)#<b>route-target export 300:100 </b> <br>
R1(config-vrf)#<b>route-target import 300:110 </b> <br>
R1(config-vrf)#<b>ip vrf CUST_Z_2                  </b> <br>
R1(config-vrf)#<b>rd 200:2                  </b> <br>
R1(config-vrf)#<b>route-target export 200:110 </b> <br>
R1(config-vrf)#<b>route-target import 200:100 </b> <br>
</code></div>
</code></div>
</p>
<p>
The command <code style="font-size:120%;"><b>vrf upgrade-cli multi-af-mode common-policies</b></code> 
will apply the same RT values configured for address-family IPv4 to IPv6 
configuration automatically. This makes applying the same configuration 
of IPv4 VRFs to IPv6 much easier.

When configuring RT or other settings in new format VRF, the address family 
configuration takes precedence over any other similar configuration that may have been
configured under the VRF sub-mode.
</p>

<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code style="font-size:130%">
R1(config)#<b>vrf upgrade-cli multi-af-mode common-policies</b>                <br>
You are about to upgrade to the multi-AF VRF syntax commands.                  <br>
You will lose any IPv6 address configured on interfaces                        <br>
belonging to upgraded VRFs.                                                    <br>
                                                                               <br>
Are you sure ? [yes]: <b>yes</b>                                               <br>
Number of VRFs upgraded: 2                                                     <br>
R1(config)#                                                                    <br>
R1(config)#                                                                    <br>
R1(config)#<b>do show vrf detail</b>                                                  <br>
VRF CUST_X_HQ (VRF Id = 1); default RD 300:100; default VPNID &lt;not set&gt;  <br>
&nbsp;&nbsp;No interfaces                                                                <br>
Address family ipv4 (Table ID = 1 (0x1)):                                      <br>
&nbsp;&nbsp;Export VPN route-target communities                                          <br>
&nbsp;&nbsp;&nbsp;&nbsp;RT:300:100                                                                 <br>
&nbsp;&nbsp;Import VPN route-target communities                                          <br>
&nbsp;&nbsp;&nbsp;&nbsp;RT:300:110                                                                 <br>
&nbsp;&nbsp;No import route-map                                                          <br>
&nbsp;&nbsp;No export route-map                                                          <br>
&nbsp;&nbsp;VRF label distribution protocol: not configured                              <br>
&nbsp;&nbsp;VRF label allocation mode: per-prefix                                        <br>
Address family ipv6 not active                                                 <br>
&nbsp;&nbsp;&nbsp;&nbsp;                                                                           <br>
VRF CUST_Z_2 (VRF Id = 2); default RD 200:2; default VPNID &lt;not set&gt;     <br>
&nbsp;&nbsp;Interfaces:                                                                  <br>
&nbsp;&nbsp;&nbsp;&nbsp;Gi2/0                                                                      <br>
Address family ipv4 (Table ID = 2 (0x2)):                                      <br>
&nbsp;&nbsp;Export VPN route-target communities                                          <br>
&nbsp;&nbsp;&nbsp;&nbsp;RT:200:110                                                                 <br>
&nbsp;&nbsp;Import VPN route-target communities                                          <br>
&nbsp;&nbsp;&nbsp;&nbsp;RT:200:100                                                                 <br>
&nbsp;&nbsp;No import route-map                                                          <br>
&nbsp;&nbsp;No export route-map                                                          <br>
&nbsp;&nbsp;VRF label distribution protocol: not configured                              <br>
&nbsp;&nbsp;VRF label allocation mode: per-prefix                                        <br>
Address family ipv6 not active                                                 <br>
                                                                               <br>
R1(config)#                                                                    <br>

</code></div>

<h3 id="VERIFICATION">Verification</h3>
<p>
To verify the creation of VRFs, use the command <code style="font-size:120%;"><b>show vrf</b></code> 
as demonstrated above.

<h2>Step 3: Configure iBGP Peering between the PE routers using VPNv4 address-family</h2>
<p>
Configure an iBGP peering between the PE routers. This iBGP peering should be 
formed using the VPNv4 address family. iBGP neighborships occur over a maximum 
of 255 hops. To configure an iBGP neigborship on R1;
</p>
<p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
R1(config)#<b>router bgp 100                                 </b>  <br>
R1(config-router)#<b>bgp log-neighbor-changes                  </b>  <br>
R1(config-router)#<b>no bgp default ipv4-unicast               </b>  <br>
R1(config-router)#<b>neighbor 30.255.6.6 remote-as 100          </b>  <br>
R1(config-router)#<b>neighbor 30.255.6.6 update-source Loopback255 </b>  <br>
R1(config-router)#<b>address-family vpnv4 unicast                      </b>  <br>
R1(config-router-af)#<b>neighbor 30.255.6.6 activate              </b>  <br>
R1(config-router-af)#<b>exit-address-family                    </b>  <br>
                                                              <br>
!On R6                                                         <br>
                                                              <br>
R6(config)#<b>router bgp 100                                 </b>  <br>
R6(config-router)#<b>bgp log-neighbor-changes                  </b>  <br>
R6(config-router)#<b>no bgp default ipv4-unicast               </b>  <br>
R6(config-router)#<b>neighbor 30.255.1.1 remote-as 100          </b>  <br>
R6(config-router)#<b>neighbor 30.255.1.1 update-source Loopback255 </b>  <br>
R6(config-router)#<b>address-family vpnv4                      </b>  <br>
R6(config-router-af)#<b>neighbor 30.255.1.1 activate              </b>  <br>
R6(config-router-af)#<b>exit-address-family                    </b>  <br>
</code>
</div>
<p>
The command <code style="font-size:120%;"><b>neighbor 30.255.1.1 send-community extended</b></code> is 
automatically added by MP-BGP as it uses extended communities to route VPNv4 
traffic. This can be verified by the command <code style="font-size:120%;"><b>show run | section bgp</b></code>.
</p>

<h3>Verification</h3>
<p>
Once the iBGP peering has been completed, this neighborship can be confirmed 
using the command <code style="font-size:120%;"><b>show bgp vpnv4 unicast all summary</b></code>. The 
result of this command is indicated in the following snippet.
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
R1#<b>show bgp vpnv4 unicast all summary</b>                                                  <br>
BGP router identifier 30.255.1.1, local AS number 100                                  <br>
BGP table version is 56, main routing table version 56                                 <br>
39 network entries using 6552 bytes of memory                                          <br>
39 path entries using 2496 bytes of memory                                             <br>
6/6 BGP path/bestpath attribute entries using 864 bytes of memory                      <br>
5 BGP extended community entries using 1040 bytes of memory                            <br>
0 BGP route-map cache entries using 0 bytes of memory                                  <br>
0 BGP filter-list cache entries using 0 bytes of memory                                <br>
BGP using 10952 total bytes of memory                                                  <br>
BGP activity 47/8 prefixes, 47/8 paths, scan interval 60 secs                          <br>
                                                                                       <br>
Neighbor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AS MsgRcvd MsgSent&nbsp;&nbsp; TblVer&nbsp;&nbsp;InQ OutQ Up/Down&nbsp;&nbsp;State/PfxRcd<br>
30.255.5.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;87&nbsp;&nbsp;&nbsp;&nbsp; 105&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;0 01:28:23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5    <br>
30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;67&nbsp;&nbsp;&nbsp;&nbsp; 103&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;0 01:28:04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 12    <br>
</code>
</div>
<p>
This shows that the iBGP peering was created. A second iBGP peer(R5) was configured.
</p>

<p>
To confirm if extended BGP communities are being sent: 
<code><b>debug bgp vpnv4 unicast updates</b></code> 
</p>
<p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
*Apr 14 05:57:04.319: BGP(4): 30.255.6.6 rcvd UPDATE w/ attr: nexthop 30.255.6.6, origin ?, localpref 100, metric 2, extended community RT:200:100 OSPF DOMAIN ID:0x0005:0x000003E80200 OSPF RT:0.0.0.1:2:0 OSPF ROUTER ID:10.255.67.2:0<br>
*Apr 14 05:57:04.331: BGP(4): 30.255.6.6 rcvd 200:1:10.7.7.1/32, label 44 <br>
*Apr 14 05:57:04.351: BGP(4): Revise route installing 1 of 1 routes for 10.7.7.1/32 -> 30.255.6.6(CUST_Z_2) to CUST_Z_2 IP table<br>
</code></div>
</p>

<h2>Step 4: IGP Peering and Route Exchange Between the PE And CE Devices</h2>
<p>
This can be implemented through configuration of an IGP between the PE-CE routers 
or BGP with an eBGP relationship. Some customers may prefer running BGP at the PE-CE. 
This routing protocol is to share the customer routes from the CE to the PE.
</p>
<p>
When configuring the routing protocol, the physical interface that the PE connects
to the CE should be placed in the appropriate VRF that was configured for the 
customer to which that interface points. Between CE R1 and PE R2, the configured 
routing protocol is EIGRP with named EIGRP being configured on R2.
</p>
<p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
R1(config)#<b>interface g3/0                                                                         </b><br>
R1(config-if)#<b>vrf forwarding CUST_Z_2</b><br> 
% Interface GigabitEthernet3/0 IPv4 disabled and address(es) removed due to enabling VRF CUST_Z_2      </b><br>
R1(config-if)#<b>ip address 10.255.19.1 255.255.255.252</b><br>
R1(config)#<b>router eigrp EIGRP_NAMED</b><br>
R1(config-router)#<b>address-family ipv4 unicast vrf CUST_Z_2 autonomous-system 10 </b><br>
R1(config-router-af)#<b>network 10.255.19.0 0.0.0.3  </b><br>
R1(config-router-af)#<b>topology base </b><br>
R1(config-router-af)#<b>redistribute bgp 100 metric 100000 100 200 1 1500 </b><br>
</code></div>
</p>
<p>
On R9:
</p>
<p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
R9(config-if)#<b>router eigrp EIGRP_Z_S2                                                        </b><br>
R9(config-router)#<b>address-family ipv4 unicast autonomous-system 10                             </b><br>
R9(config-router-af)#<b>network 10.255.19.0 0.0.0.3                                                   </b><br>
R9(config-router-af)#<b>network 10.90.0.0 0.0.255.255                                                   </b><br>
</code>
</div>
</p>
<p>
Note that VRFs are only configured on the PE routers. On CE routers, VRFs are 
not required for MPLS L3VPN functionality. If they are configured, then it could 
be for another purpose unrelated to MPLS L3VPN.
</p>
<p>
The IGPs on the running on the PE-CE interfaces of the different PE-CE pairings 
does not have to be the same. To illustrate this, the PE-CE IGP on R7 is OSPF.
</p>



<h2>Step 5: Redistribute Routes Between MP-BGP VRF Address-family and PE-CE Routing Protocol</h2>
<p>
Route redistribution between the IGP and MP-BGP occurs at the PE router. Customer 
routes learned from the remote PE router are stored in the MP-BGP VPNv4 table. 
These can then be redistributed into the IGP running on the PE-CE link. Also, 
routes learned from the connected customer site through the IGP can be 
redistributed into MP-BGP to be forwarded to the remote customer site. This is 
accomplished using the redistribution command in the appropriate address-family.
</p>
<p>
On R2:
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
R1(config)#<b>router bgp 100                                                </b>    <br>
R1(config-router)#<b>no bgp default ipv4-unicast                              </b>    <br>
!REDISTRIBUTE CUST_X_HQ ROUTES INTO MP-BGP (LOCAL CUSTOMER SITE TO REMOTE SITES)  <br>
R1(config-router)#<b>address-family ipv4 vrf CUST_X_HQ                           </b>    <br>
R1(config-router-af)#<b>redistribute eigrp 10                                 </b>    <br>
R1(config-router-af)#<b>exit-address-family                                   </b>    <br>
R1(config-router)#<b>exit                                                     </b>    <br>
!REDISTRIBUTE MP-BGP ROUTES INTO EIGRP (REMOTE CUSTOMER SITES TO LOCAL SITE)   <br>
R1(config)#<b>router eigrp EIGRP_Z_S2                                    </b>    <br>
R1(config-router)#<b>address-family ipv4 vrf CUST_X_HQ autonomous-system 10      </b>    <br>
R1(config-router-af)#<b>topology base                                         </b>    <br>
R1(config-router-af-topology)#<b>redistribute bgp 100 100000 100 250 10 1500</b>
</code></div>
</p>
<p>
On R5
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
R5(config)#<b>router bgp 100                                </b> <br>
R5(config-router)#<b>address-family ipv4 vrf CUST_X_2    </b> <br>
R5(config-router-af)#<b>redistribute eigrp 10                </b> <br>
R5(config-router-af)#<b>exit-address-family                   </b> <br>
R5(config-router)#<b>exit                                     </b> <br>
R5(config)#<b>router eigrp EIGRP_Z_S2</b> <br>
R1(config-router)#<b>address-family ipv4 vrf CUST_X_2 autonomous-system 10      </b>    <br>
R1(config-router-af)#<b>topology base                                         </b>    <br>
R1(config-router-af-topology)#<b>redistribute bgp 100 100000 100 250 10 1500</b><br>
R5(config-router-af)#<b>exit-address-family                   </b>
</code></div>
<p>
Note that with eBGP, no redistribution of PE-CE routes is required. These routes 
will simply be shared through the eBGP relationship from MP-BGP.
</p>

<h3>Verification</h3>
<p>
To verify that the appropriate routes have been redistributed;
</p>
<p>
On the PE router;
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
R1#<b>show ip route vrf CUST_Z_2</b>                                           <br>       
                                                                               <br>
Routing Table: CUST_Z_2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <br>
Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP&nbsp;&nbsp;    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; E1 - OSPF external type 1, E2 - OSPF external type 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ia - IS-IS inter area, * - candidate default, U - per-user static route <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o - ODR, P - periodic downloaded static route, H - NHRP, l - LISP&nbsp;&nbsp;&nbsp;&nbsp;   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + - replicated route, % - next hop override&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
Gateway of last resort is not set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.0.0.0/8 is variably subnetted, 18 subnets, 3 masks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <br>
D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.9.1.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [90/2570240] via 10.255.19.2, 01:04:15, GigabitEthernet3/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <br>
D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.9.2.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [90/2570240] via 10.255.19.2, 01:04:15, GigabitEthernet3/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <br>
D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.9.3.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [90/2570240] via 10.255.19.2, 01:04:15, GigabitEthernet3/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <br>
D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.9.4.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [90/2570240] via 10.255.19.2, 01:04:15, GigabitEthernet3/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <br>
B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.10.1.0/24 [200/2] via 30.255.6.6, 00:30:17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.10.2.0/24 [200/2] via 30.255.6.6, 00:30:17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.10.3.0/24 [200/2] via 30.255.6.6, 00:30:17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.10.4.0/24 [200/2] via 30.255.6.6, 00:30:17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.10.5.0/24 [200/2] via 30.255.6.6, 00:30:17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.10.6.0/24 [200/2] via 30.255.6.6, 00:30:17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.10.7.0/24 [200/2] via 30.255.6.6, 00:30:17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.10.8.0/24 [200/2] via 30.255.6.6, 00:30:17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.10.9.0/24 [200/2] via 30.255.6.6, 00:30:17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.10.10.0/24 [200/2] via 30.255.6.6, 00:30:17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <br>
B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.10.255.1/32 [200/2] via 30.255.6.6, 00:30:17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.19.0/30 is directly connected, GigabitEthernet3/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <br>
L&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.19.1/32 is directly connected, GigabitEthernet3/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <br>
B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.67.0/30 [200/0] via 30.255.6.6, 00:39:18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
R1#<br>
R1#<br>
R1#<b>show bgp vpnv4 unicast vrf CUST_Z_2</b>                                     <br>
BGP table version is 38, local router ID is 30.255.1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  <br>
Status codes: s suppressed, d damped, h history, * valid, &gt; best, i - internal,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r RIB-failure, S Stale, m multipath, b backup-path, f RT-Filter,    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x best-external, a additional-path, c RIB-compressed,               <br>
Origin codes: i - IGP, e - EGP, ? - incomplete&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  <br>
RPKI validation codes: V valid, I invalid, N Not found&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  <br>
&nbsp;&nbsp;&nbsp;&nbsp; Network&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Next Hop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Metric LocPrf Weight Path               <br>
Route Distinguisher: 200:2 (default for vrf CUST_Z_2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br>
 *>i 10.7.1.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?                  <br>
 *>i 10.7.2.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?                  <br>
 *>i 10.7.3.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?                  <br>
 *>i 10.7.4.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?                  <br>
 *>i 10.7.5.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?                  <br>
 *>i 10.7.7.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?                  <br>
 *>&nbsp;&nbsp;10.9.1.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.19.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2570240&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 32768 ?                  <br>
 *>&nbsp;&nbsp;10.9.2.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.19.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2570240&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 32768 ?                  <br>
 *>&nbsp;&nbsp;10.9.3.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.19.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2570240&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 32768 ?                  <br>
 *>&nbsp;&nbsp;10.9.4.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.19.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2570240&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 32768 ?                  <br>
 *>i 10.10.255.1/32&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?                  <br>
 *>&nbsp;&nbsp;10.255.19.0/30&nbsp;&nbsp; 0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 32768 ?                  <br>
 *>i 10.255.67.0/30&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?                  <br>
R1#
</code></div>
</p>

<p>
On the CE router;
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
R9><b>show ip route</b> <br>
Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP       <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area           <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2           <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; E1 - OSPF external type 1, E2 - OSPF external type 2                     <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ia - IS-IS inter area, * - candidate default, U - per-user static route  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o - ODR, P - periodic downloaded static route, H - NHRP, l - LISP        <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + - replicated route, % - next hop override                              <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                <br>
Gateway of last resort is not set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.0.0.0/8 is variably subnetted, 18 subnets, 3 masks                     <br>
D EX&nbsp;&nbsp;&nbsp;&nbsp; 10.7.1.0/24 [170/51456] via 10.255.19.1, 00:26:27, GigabitEthernet0/0  <br>
D EX&nbsp;&nbsp;&nbsp;&nbsp; 10.7.2.0/24 [170/51456] via 10.255.19.1, 00:26:27, GigabitEthernet0/0  <br>
D EX&nbsp;&nbsp;&nbsp;&nbsp; 10.7.3.0/24 [170/51456] via 10.255.19.1, 00:26:27, GigabitEthernet0/0  <br>
D EX&nbsp;&nbsp;&nbsp;&nbsp; 10.7.4.0/24 [170/51456] via 10.255.19.1, 00:26:27, GigabitEthernet0/0  <br>
D EX&nbsp;&nbsp;&nbsp;&nbsp; 10.7.5.0/24 [170/51456] via 10.255.19.1, 00:26:27, GigabitEthernet0/0  <br>
D EX&nbsp;&nbsp;&nbsp;&nbsp; 10.7.7.1/32 [170/51456] via 10.255.19.1, 00:07:41, GigabitEthernet0/0  <br>
C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.9.1.0/24 is directly connected, Loopback1                           <br>
L&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.9.1.1/32 is directly connected, Loopback1                           <br>
C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.9.2.0/24 is directly connected, Loopback2                           <br>
L&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.9.2.1/32 is directly connected, Loopback2                           <br>
C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.9.3.0/24 is directly connected, Loopback3                           <br>
L&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.9.3.1/32 is directly connected, Loopback3                           <br>
C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.9.4.0/24 is directly connected, Loopback4                           <br>
L&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.9.4.1/32 is directly connected, Loopback4                           <br>
D EX&nbsp;&nbsp;&nbsp;&nbsp; 10.10.255.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [170/51456] via 10.255.19.1, 00:26:27, GigabitEthernet0/0            <br>
C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.19.0/30 is directly connected, GigabitEthernet0/0               <br>
L&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.19.2/32 is directly connected, GigabitEthernet0/0               <br>
D EX&nbsp;&nbsp;&nbsp;&nbsp; 10.255.67.0/30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [170/51456] via 10.255.19.1, 00:26:27, GigabitEthernet0/0            <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;99.0.0.0/32 is subnetted, 1 subnets&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                 <br>
C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;99.255.9.9 is directly connected, Loopback255                          <br>
R9>                                                                             <br>
R9>                                                                             <br>
R9>                                                                             <br>
R9>ping 10.7.7.1                                                                <br>
Type escape sequence to abort.                                                  <br>
Sending 5, 100-byte ICMP Echos to 10.7.7.1, timeout is 2 seconds:               <br>
!!!!!                                                                           <br>
Success rate is 100 percent (5/5), round-trip min/avg/max = 84/100/128 ms       <br>
R9>

</code></div>
</p>
<h4><code>show bgp vpnv4 unicast all</code></h4>

<p>
Remote customer site routes are exchanged through L3VPN and are installed in the 
MP-BGP VRF table. This can be verified by the command; 
<code style="font-size:120%;"><b>show bgp vpnv4 unicast all</b></code>. This shows the routes in the 
MP-BGP table for all VRFs.
</p>

<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">

R1#<b>show bgp vpnv4 unicast all</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br>   
BGP table version is 40, local router ID is 30.255.1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br>
Status codes: s suppressed, d damped, h history, * valid, &gt; best, i - internal, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r RIB-failure, S Stale, m multipath, b backup-path, f RT-Filter,     <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x best-external, a additional-path, c RIB-compressed,                <br>
Origin codes: i - IGP, e - EGP, ? - incomplete&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br>
RPKI validation codes: V valid, I invalid, N Not found&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br>
&nbsp;&nbsp;&nbsp;&nbsp; Network&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Next Hop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Metric LocPrf Weight Path                <br>
Route Distinguisher: 200:1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br>
 *>i 10.10.1.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.2.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.3.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.4.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.5.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.6.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.7.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.8.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.9.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.10.0/24&nbsp;&nbsp;&nbsp;&nbsp;30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.255.1/32&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.255.67.0/30&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
Route Distinguisher: 200:2 (default for vrf CUST_Z_2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                <br>
&nbsp;&nbsp;&nbsp;&nbsp; Network&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Next Hop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Metric LocPrf Weight Path                <br>
 *>&nbsp;&nbsp;10.9.1.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.19.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2570240&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 32768 ?&nbsp;&nbsp;                 <br>
 *>&nbsp;&nbsp;10.9.2.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.19.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2570240&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 32768 ?&nbsp;&nbsp;                 <br>
 *>&nbsp;&nbsp;10.9.3.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.19.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2570240&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 32768 ?&nbsp;&nbsp;                 <br>
 *>&nbsp;&nbsp;10.9.4.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.19.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2570240&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 32768 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.1.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.2.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.3.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.4.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.5.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.6.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.7.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.8.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.9.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.10.0/24&nbsp;&nbsp;&nbsp;&nbsp;30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.10.255.1/32&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>&nbsp;&nbsp;10.255.19.0/30&nbsp;&nbsp; 0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 32768 ?&nbsp;&nbsp;                 <br>
 *>i 10.255.67.0/30&nbsp;&nbsp; 30.255.6.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
Route Distinguisher: 300:100 (default for vrf CUST_X_HQ)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br>
 *>i 10.80.1.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.5.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10880&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.80.2.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.5.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10880&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.80.3.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.5.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10880&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.80.4.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.5.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10880&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
&nbsp;&nbsp;&nbsp;&nbsp; Network&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Next Hop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Metric LocPrf Weight Path                <br>
 *>i 10.255.58.0/30&nbsp;&nbsp; 30.255.5.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
Route Distinguisher: 300:110&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br>
 *>i 10.80.1.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.5.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10880&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.80.2.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.5.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10880&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.80.3.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.5.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10880&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.80.4.0/24&nbsp;&nbsp;&nbsp;&nbsp; 30.255.5.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10880&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
 *>i 10.255.58.0/30&nbsp;&nbsp; 30.255.5.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ?&nbsp;&nbsp;                 <br>
R1#                                                                                  	
</code></div>
<p>
Note that the routes learned through MP-BGP VPNv4, have the next-hop as the iBGP remote PE peer.
</p>

<p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code style="font-size:130%">
R1#<b>show bgp vpnv4 unicast all 10.80.1.0</b>                                <br>
BGP routing table entry for 300:100:10.80.1.0/24, version 15                  <br>
Paths: (1 available, best #1, table CUST_X_HQ)                                <br>
&nbsp;&nbsp;Not advertised to any peer                                                  <br>
&nbsp;&nbsp;Refresh Epoch 1                                                             <br>
&nbsp;&nbsp;Local, imported path from 300:110:10.80.1.0/24                              <br>
&nbsp;&nbsp;&nbsp;&nbsp;30.255.5.5 (metric 3) from 30.255.5.5 (30.255.5.5)                        <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Origin incomplete, metric 10880, localpref 100, valid, internal, best   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Extended Community: RT:300:110 Cost:pre-bestpath:128:10880              <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x8800:32768:0 0x8801:10:256 0x8802:65281:2560 0x8803:65281:1500      <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x8806:0:1493108744                                                   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mpls labels in/out nolabel/5018                                         <br>
BGP routing table entry for 300:110:10.80.1.0/24, version 11                  <br>
Paths: (1 available, best #1, no table)                                       <br>
&nbsp;&nbsp;Not advertised to any peer                                                  <br>
&nbsp;&nbsp;Refresh Epoch 1                                                             <br>
&nbsp;&nbsp;Local&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                 <br>
&nbsp;&nbsp;&nbsp;&nbsp;30.255.5.5 (metric 3) from 30.255.5.5 (30.255.5.5)                        <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Origin incomplete, metric 10880, localpref 100, valid, internal, best   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Extended Community: RT:300:110 Cost:pre-bestpath:128:10880              <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x8800:32768:0 0x8801:10:256 0x8802:65281:2560 0x8803:65281:1500      <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x8806:0:1493108744                                                   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mpls labels in/out nolabel/5018                                         <br>
R1#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</code></div>
</p>
<p>
From this output, the details of EIGRP composite metrics are encoded in the BGP extended
community.
</p>
<h3>EIGRP</h3>
<p>
When redistributing prefixes into EIGRP, ensure that the seed metric is configured.
</p>
<p>
Verification: <code><b>show ip eigrp vrf &lt;vrf-name&gt; topology</b></code>. 
Some prefixes will have VPNv4 as the route source.
</p>

<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code style="font-size:130%">               
R1><b>show ip eigrp vrf CUST_Z_2 topology</b>                               <br>        
EIGRP-IPv4 VR(EIGRP_PE) Topology Table for AS(10)/ID(10.255.19.1)    <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Topology(base) TID(0) VRF(CUST_Z_2)                       <br>        
Codes: P - Passive, A - Active, U - Update, Q - Query, R - Reply,    <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; r - reply Status, s - sia Status                              <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                   <br>        
P 10.10.8.0/24, 1 successors, FD is 72089600                         <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via Redistributed (72089600/0)                               <br>        
P 10.9.1.0/24, 1 successors, FD is 328990720                         <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via 10.255.19.2 (328990720/327761920), GigabitEthernet3/0    <br>        
P 10.10.5.0/24, 1 successors, FD is 72089600                         <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via Redistributed (72089600/0)                               <br>        
P 10.9.2.0/24, 1 successors, FD is 328990720                         <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via 10.255.19.2 (328990720/327761920), GigabitEthernet3/0    <br>        
P 10.255.19.0/30, 1 successors, FD is 1310720                        <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via Connected, GigabitEthernet3/0                            <br>        
P 10.9.3.0/24, 1 successors, FD is 328990720                         <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via 10.255.19.2 (328990720/327761920), GigabitEthernet3/0    <br>        
P 10.255.67.0/30, 1 successors, FD is 72089600                       <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via Redistributed (72089600/0)                               <br>        
P 10.9.4.0/24, 1 successors, FD is 328990720                         <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via 10.255.19.2 (328990720/327761920), GigabitEthernet3/0    <br>        
P 10.10.4.0/24, 1 successors, FD is 72089600                         <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via Redistributed (72089600/0)                               <br>        
P 10.10.9.0/24, 1 successors, FD is 72089600                         <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via Redistributed (72089600/0)                               <br>        
P 10.10.6.0/24, 1 successors, FD is 72089600                         <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via Redistributed (72089600/0)                               <br>        
P 10.10.7.0/24, 1 successors, FD is 72089600                         <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via Redistributed (72089600/0)                               <br>        
P 10.10.255.1/32, 1 successors, FD is 72089600                       <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via Redistributed (72089600/0)                               <br>        
P 10.10.2.0/24, 1 successors, FD is 72089600                         <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via Redistributed (72089600/0)                               <br>        
P 10.10.10.0/24, 1 successors, FD is 72089600                        <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via Redistributed (72089600/0)                               <br>        
P 10.10.1.0/24, 1 successors, FD is 72089600                         <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via Redistributed (72089600/0)                               <br>        
P 10.10.3.0/24, 1 successors, FD is 72089600                         <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via Redistributed (72089600/0)                               <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                   <br>        
R1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                  <br>         
R1><b>show ip eigrp vrf CUST_Z_2 topology 10.10.1.0/24</b>                  <br>        
EIGRP-IPv4 VR(EIGRP_PE) Topology Entry for AS(10)/ID(10.255.19.1)    <br>        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Topology(base) TID(0) VRF(CUST_Z_2)                       <br>        
EIGRP-IPv4(10): Topology base(0) entry for 10.10.1.0/24              <br>        
&nbsp;&nbsp;State is Passive, Query origin flag is 1, 1 Successor(s), FD is 72089600 <br>  
&nbsp;&nbsp;Descriptor Blocks:                                                       <br>  
&nbsp;&nbsp;30.255.6.6, from Redistributed, Send flag is 0x0                         <br>  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Composite metric is (72089600/0), route is External                  <br>  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vector metric:                                                       <br>  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Minimum bandwidth is 100000 Kbit                                   <br>  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Total delay is 1000000000 picoseconds                              <br>  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reliability is 200/255                                             <br>  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Load is 1/255                                                      <br>  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Minimum MTU is 1500                                                <br>  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hop count is 0                                                     <br>  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Originating router is 10.255.19.1                                  <br>  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;External data:                                                       <br>  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS number of route is 100                                          <br>  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;External protocol is BGP, external metric is 2                     <br>  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Administrator tag is 0 (0x00000000)                                <br>  
R1>                                                                          
</code></div>

<h3>OSPF</h3>
<p>
Enabling OSPF on an interface that is already part of a VRF makes the OSPF 
process VRF-aware.
</p>


<h4>External Routes as Inter-area Routes</h4>
<p>
The OSPF behaviour when redistributing BGP routes into OSPF is for the routes to
be external routes E1 or E2.
</p>
<p>
The following output shows the OSPF database of a remote PE router:
</p>
<p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code style="font-size:130%">
R5#<b>show ip ospf 1001 database</b>                                      <br>                
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  <br>         
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OSPF Router with ID (10.255.58.1) (Process ID 1001)           <br>         
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  <br>         
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Router Link States (Area 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br>         
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  <br>         
Link ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ADV Router&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Age&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Seq#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Checksum Link count<br>         
10.255.58.1&nbsp;&nbsp;&nbsp;&nbsp; 10.255.58.1&nbsp;&nbsp;&nbsp;&nbsp; 1196&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x80000006 0x00BD57 1         <br>         
88.255.8.8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;88.255.8.8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x80000006 0x00E82C 5         <br>         
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  <br>         
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Net Link States (Area 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  <br>         
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  <br>         
Link ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ADV Router&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Age&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Seq#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Checksum           <br>         
10.255.58.2&nbsp;&nbsp;&nbsp;&nbsp; 88.255.8.8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x80000004 0x00617C           <br>         
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  <br>         
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Type-5 AS External Link States&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  <br>         
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  <br>         
Link ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ADV Router&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Age&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Seq#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Checksum Tag       <br>         
10.10.1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10.255.58.1&nbsp;&nbsp;&nbsp;&nbsp; 28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x80000001 0x00EEB2 3489661028<br>         
10.10.2.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10.255.58.1&nbsp;&nbsp;&nbsp;&nbsp; 28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x80000001 0x00E3BC 3489661028<br>         
10.10.3.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10.255.58.1&nbsp;&nbsp;&nbsp;&nbsp; 28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x80000001 0x00D8C6 3489661028<br>         
10.10.4.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10.255.58.1&nbsp;&nbsp;&nbsp;&nbsp; 28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x80000001 0x00CDD0 3489661028<br>         
10.10.5.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10.255.58.1&nbsp;&nbsp;&nbsp;&nbsp; 28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x80000001 0x00C2DA 3489661028<br>         
10.255.110.0&nbsp;&nbsp;&nbsp;&nbsp;10.255.58.1&nbsp;&nbsp;&nbsp;&nbsp; 28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x80000001 0x00A1A1 3489661028<br>         
</code></div>
</p>
<p>
On the CE router, these prefixes are E2 routes:
</p>
<p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code style="font-size:130%">
R8><b>show ip route</b><br>
Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP      <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area          <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2          <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; E1 - OSPF external type 1, E2 - OSPF external type 2                    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ia - IS-IS inter area, * - candidate default, U - per-user static route <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o - ODR, P - periodic downloaded static route, H - NHRP, l - LISP       <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + - replicated route, % - next hop override                             <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                         <br>
Gateway of last resort is not set                                              <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                         <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.0.0.0/8 is variably subnetted, 16 subnets, 3 masks                    <br>
O E2&nbsp;&nbsp;&nbsp;&nbsp; 10.10.1.1/32 [110/2] via 10.255.58.1, 00:02:39, GigabitEthernet0/0    <br>
O E2&nbsp;&nbsp;&nbsp;&nbsp; 10.10.2.1/32 [110/2] via 10.255.58.1, 00:02:39, GigabitEthernet0/0    <br>
O E2&nbsp;&nbsp;&nbsp;&nbsp; 10.10.3.1/32 [110/2] via 10.255.58.1, 00:02:39, GigabitEthernet0/0    <br>
O E2&nbsp;&nbsp;&nbsp;&nbsp; 10.10.4.1/32 [110/2] via 10.255.58.1, 00:02:39, GigabitEthernet0/0    <br>
O E2&nbsp;&nbsp;&nbsp;&nbsp; 10.10.5.1/32 [110/2] via 10.255.58.1, 00:02:39, GigabitEthernet0/0    <br>
.....<br>
!!!!Additional output omitted<br>
...
</code></div>
</p>
<p>
With VPNv4, OSPF on the PE LSRs can be configured to consider these routes as 
internal(inter-area). OSPF and BGP VPNv4 operate differently from normal redistribution.
These routes are considered internal routes for the purpose of loop prevention 
and traffic engineering. Note that when redistributing prefixes into OSPF, excluding 
the <code><b>subnets</b></code> keyword results in classful prefixes being 
advertised. 
</p>

<p>
The output of <code><b>show ip ospf &lt;process-ID&gt;</b></code> on the PE 
router displays the output "<code><b>Domain ID type.. value ...</b></code>".
The value is inherited from the OSPF process ID. 
</P>
<p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code style="font-size:130%">
R1#<b>show ip ospf 1000</b><br>
 Routing Process "ospf 1000" with ID 10.255.1.1                                <br>
&nbsp;&nbsp; <span style="background:gray;">Domain ID type 0x0005, value 0.0.3.232</span><br>
 Start time: 00:00:36.340, Time elapsed: 01:48:49.108                          <br>
 Supports only single TOS(TOS0) routes                                         <br>
 Supports opaque LSA                                                           <br>
 Supports Link-local Signaling (LLS)                                           <br>
 Supports area transit capability                                              <br>
 Supports NSSA (compatible with RFC 3101)                                      <br>
 Connected to MPLS VPN Superbackbone, VRF CUST_X_HQ                            <br>
 Event-log disabled                                                            <br>
 It is an area border and autonomous system boundary router                    <br>
 Redistributing External Routes from,                                          <br>
&nbsp;&nbsp;&nbsp;&nbsp;bgp 100, includes subnets in redistribution                                <br>
 Router is not originating router-LSAs with maximum metric                     <br>
 Initial SPF schedule delay 5000 msecs                                         <br>
 Minimum hold time between two consecutive SPFs 10000 msecs                    <br>
 Maximum wait time between two consecutive SPFs 10000 msecs                    <br>
 Incremental-SPF disabled                                                      <br>
 Minimum LSA interval 5 secs                                                   <br>
 Minimum LSA arrival 1000 msecs                                                <br>
 LSA group pacing timer 240 secs                                               <br>
 Interface flood pacing timer 33 msecs                                         <br>
 Retransmission pacing timer 66 msecs                                          <br>
 Number of external LSA 0. Checksum Sum 0x000000                               <br>
 Number of opaque AS LSA 0. Checksum Sum 0x000000                              <br>
 Number of DCbitless external and opaque AS LSA 0                              <br>
 Number of DoNotAge external and opaque AS LSA 0                               <br>
 Number of areas in this router is 1. 1 normal 0 stub 0 nssa                   <br>
 Number of areas transit capable is 0                                          <br>
 External flood list length 0                                                  <br>
 IETF NSF helper support enabled                                               <br>
 Cisco NSF helper support enabled                                              <br>
 Reference bandwidth unit is 100 mbps                                          <br>
&nbsp;&nbsp;&nbsp;&nbsp;Area 1                                                                     <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of interfaces in this area is 1                                 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Area has no authentication                                             <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPF algorithm last executed 01:11:49.224 ago                           <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPF algorithm executed 2 times                                         <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Area ranges are                                                        <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of LSA 9. Checksum Sum 0x02ADF2                                 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of opaque link LSA 0. Checksum Sum 0x000000                     <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of DCbitless LSA 0                                              <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of indication LSA 0                                             <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of DoNotAge LSA 0                                               <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flood list length 0                                                    
</code></div>        
</p>
<p>
On the remote PE R5:
</p>
<p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code style="font-size:130%">
R5(config-if)#<b>do show ip ospf 1001</b><br>
 Routing Process "ospf 1001" with ID 10.255.58.1               <br>
&nbsp;&nbsp; <span style="background:gray;">Domain ID type 0x0005, value 0.0.3.233</span><br>
 Start time: 00:15:57.372, Time elapsed: 00:13:48.868          <br>
 Supports only single TOS(TOS0) routes                         <br>
 Supports opaque LSA&nbsp;&nbsp;                                         <br>
 Supports Link-local Signaling (LLS)                           <br>
 Supports area transit capability                              <br>
 Supports NSSA (compatible with RFC 3101)                      <br>
 Connected to MPLS VPN Superbackbone, VRF CUST_X_2             <br>
 Event-log disabled&nbsp;&nbsp;                                          <br>
 It is an area border and autonomous system boundary router    <br>
 Redistributing External Routes from,                          <br>
&nbsp;&nbsp;&nbsp;&nbsp;bgp 100, includes subnets in redistribution                <br>
 Router is not originating router-LSAs with maximum metric     <br>
 Initial SPF schedule delay 5000 msecs                         <br>
 Minimum hold time between two consecutive SPFs 10000 msecs    <br>
 Maximum wait time between two consecutive SPFs 10000 msecs    <br>
 Incremental-SPF disabled                                      <br>
 Minimum LSA interval 5 secs                                   <br>
 Minimum LSA arrival 1000 msecs                                <br>
 LSA group pacing timer 240 secs                               <br>
 Interface flood pacing timer 33 msecs                         <br>
 Retransmission pacing timer 66 msecs                          <br>
 Number of external LSA 6. Checksum Sum 0x04DD7F               <br>
 Number of opaque AS LSA 0. Checksum Sum 0x000000              <br>
 Number of DCbitless external and opaque AS LSA 0              <br>
 Number of DoNotAge external and opaque AS LSA 0               <br>
 Number of areas in this router is 1. 1 normal 0 stub 0 nssa   <br>
 Number of areas transit capable is 0                          <br>
 External flood list length 0                                  <br>
 IETF NSF helper support enabled                               <br>
 Cisco NSF helper support enabled                              <br>
 Reference bandwidth unit is 100 mbps                          <br>
&nbsp;&nbsp;&nbsp;&nbsp;Area 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                         <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of interfaces in this area is 1                 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Area has no authentication                             <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPF algorithm last executed 00:11:09.780 ago           <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPF algorithm executed 4 times                         <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Area ranges are                                        <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of LSA 3. Checksum Sum 0x0218F6                 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of opaque link LSA 0. Checksum Sum 0x000000     <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of DCbitless LSA 0                              <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of indication LSA 0                             <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of DoNotAge LSA 0                               <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flood list length 0                                    <br>
</code></div>
</p>

<p>
If the domain ID matches on the local and remote PE devices, prefixes that were 
originally external after redistribution will be considered as inter-area routes 
after redistribution from BGP to OSPF e.g., OSPF with
process ID 1000 on both the local and remote PE devices; because the OSPF process 
ID is matching, then the routes can be encoded as inter-area routes. 
</p>
<p>
The domain-ID can be configured to be the same on the local and remote PE by:
<ul>
  <li>Configuring the same OSPF process ID on the local and remote PE.</li>
  <li>A second option is to configure the same domain-id value on the local and remote PE.</li>
</ul>
</p>
<p>
The domain-ID value can be modified in OSPF using the OSPF 
command <code><b>domain-id &lt;ip-address&gt;</b></code>; the domain-ID value is
in the form of an IPv4 address. 
If the domain-ID value is different in the OSPF process of the local and remote 
PE LSRs, then the routes redistributed from BGP to OSPF will be flagged as 
E2 external routes.

The domain-ID is encoded(in HEX) in the BGP path attributes as an extended community 
value.

The domain-ID value takes precedence over the OSPF process ID value; i.e., if the 
process IDs are different but the domain-IDs are the same, then the routes will 
be advertised as inter-area routes.
</p>

<p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code style="font-size:130%">
R5(config)#<b>router ospf 1001 vrf CUST_X_2</b>                          <br>
R5(config-router)#<b>domain-id 0.0.3.232 </b>                            <br>
R5(config-router)#<b>do show ip ospf 1001</b>                            <br>
 Routing Process "ospf 1001" with ID 10.255.58.1                  <br>
&nbsp;&nbsp; Domain ID type 0x0005, value 0.0.3.232                         <br>
 Start time: 00:15:57.372, Time elapsed: 02:33:44.228             <br>
 Supports only single TOS(TOS0) routes                            <br>
 Supports opaque LSA                                              <br>
 Supports Link-local Signaling (LLS)                              <br>
 Supports area transit capability                                 <br>
 Supports NSSA (compatible with RFC 3101)                         <br>
 Connected to MPLS VPN Superbackbone, VRF CUST_X_2                <br>
 Event-log disabled                                               <br>
 It is an area border and autonomous system boundary router       <br>
 Redistributing External Routes from,                             <br>
&nbsp;&nbsp;&nbsp;&nbsp;bgp 100, includes subnets in redistribution                   <br>
 Router is not originating router-LSAs with maximum metric        <br>
 Initial SPF schedule delay 5000 msecs                            <br>
 Minimum hold time between two consecutive SPFs 10000 msecs       <br>
 Maximum wait time between two consecutive SPFs 10000 msecs       <br>
 Incremental-SPF disabled                                         <br>
 Minimum LSA interval 5 secs                                      <br>
 Minimum LSA arrival 1000 msecs                                   <br>
 LSA group pacing timer 240 secs                                  <br>
 Interface flood pacing timer 33 msecs                            <br>
 Retransmission pacing timer 66 msecs                             <br>
 Number of external LSA 0. Checksum Sum 0x000000                  <br>
 Number of opaque AS LSA 0. Checksum Sum 0x000000                 <br>
 Number of DCbitless external and opaque AS LSA 0                 <br>
 Number of DoNotAge external and opaque AS LSA 0                  <br>
 Number of areas in this router is 1. 1 normal 0 stub 0 nssa      <br>
 Number of areas transit capable is 0                             <br>
 External flood list length 0                                     <br>
 IETF NSF helper support enabled                                  <br>
 Cisco NSF helper support enabled                                 <br>
 Reference bandwidth unit is 100 mbps                             <br>
&nbsp;&nbsp;&nbsp;&nbsp;Area 1&nbsp;&nbsp;&nbsp;&nbsp;                                                    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of interfaces in this area is 1                    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Area has no authentication                                <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPF algorithm last executed 02:31:05.160 ago              <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPF algorithm executed 4 times                            <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Area ranges are                                           <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of LSA 9. Checksum Sum 0x059C39                    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of opaque link LSA 0. Checksum Sum 0x000000        <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of DCbitless LSA 0                                 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of indication LSA 0                                <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of DoNotAge LSA 0                                  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flood list length 0                                       <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                    <br>
R5(config-router)#<b>end</b></br>
R5><b>show ip ospf 1001 database</b><br>                                               
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OSPF Router with ID (10.255.58.1) (Process ID 1001)            <br> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Router Link States (Area 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  <br> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br> 
Link ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ADV Router&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Age&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Seq#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Checksum Link count <br> 
10.255.58.1&nbsp;&nbsp;&nbsp;&nbsp; 10.255.58.1&nbsp;&nbsp;&nbsp;&nbsp; 109&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x80000008 0x00B959 1          <br> 
88.255.8.8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;88.255.8.8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;67&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x80000007 0x00E62D 5          <br> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Net Link States (Area 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br> 
Link ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ADV Router&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Age&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Seq#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Checksum            <br> 
10.255.58.2&nbsp;&nbsp;&nbsp;&nbsp; 88.255.8.8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;67&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x80000005 0x005F7D            <br> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Summary Net Link States (Area 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 <br> 
Link ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ADV Router&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Age&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Seq#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Checksum            <br> 
10.10.1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10.255.58.1&nbsp;&nbsp;&nbsp;&nbsp; 789&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x80000001 0x000E51            <br> 
10.10.2.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10.255.58.1&nbsp;&nbsp;&nbsp;&nbsp; 789&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x80000001 0x00035B            <br> 
10.10.3.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10.255.58.1&nbsp;&nbsp;&nbsp;&nbsp; 789&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x80000001 0x00F765            <br> 
10.10.4.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10.255.58.1&nbsp;&nbsp;&nbsp;&nbsp; 789&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x80000001 0x00EC6F            <br> 
10.10.5.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10.255.58.1&nbsp;&nbsp;&nbsp;&nbsp; 789&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x80000001 0x00E179            <br> 
10.255.110.0&nbsp;&nbsp;&nbsp;&nbsp;10.255.58.1&nbsp;&nbsp;&nbsp;&nbsp; 789&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x80000001 0x00C040            <br> 
</code></div>
</p>
<p>
The OSPF database on R5 shows that the routes are now considered inter-area.
</p>
<p>
On the remote site client CE, the routes are now considered inter-area:
</p>
<p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code style="font-size:130%">
R8><b>show ip route ospf</b><br>                                                <br>           
Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP       <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area           <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2           <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; E1 - OSPF external type 1, E2 - OSPF external type 2                     <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ia - IS-IS inter area, * - candidate default, U - per-user static route  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o - ODR, P - periodic downloaded static route, H - NHRP, l - LISP        <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + - replicated route, % - next hop override                              <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                    <br>
Gateway of last resort is not set                                               <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.0.0.0/8 is variably subnetted, 16 subnets, 3 masks                     <br>
O IA&nbsp;&nbsp;&nbsp;&nbsp; 10.10.1.1/32 [110/3] via 10.255.58.1, 00:10:22, GigabitEthernet0/0     <br>
O IA&nbsp;&nbsp;&nbsp;&nbsp; 10.10.2.1/32 [110/3] via 10.255.58.1, 00:10:22, GigabitEthernet0/0     <br>
O IA&nbsp;&nbsp;&nbsp;&nbsp; 10.10.3.1/32 [110/3] via 10.255.58.1, 00:10:22, GigabitEthernet0/0     <br>
O IA&nbsp;&nbsp;&nbsp;&nbsp; 10.10.4.1/32 [110/3] via 10.255.58.1, 00:10:22, GigabitEthernet0/0     <br>
O IA&nbsp;&nbsp;&nbsp;&nbsp; 10.10.5.1/32 [110/3] via 10.255.58.1, 00:10:22, GigabitEthernet0/0     <br>
O IA&nbsp;&nbsp;&nbsp;&nbsp; 10.255.110.0/30 [110/2] via 10.255.58.1, 00:10:22, GigabitEthernet0/0  <br>
</code></div>
</p>
<p>
<code><b>show ip cef</b></code> displays both the transport label and VPN label.
</p>

<h4>Superbackbone</h4>
<p>
On the PE router of the provider, in the OSPF output of the command <code><b>
show ip ospf &lt;process-ID&gt;</b></code>, the message, 
<code><b>Connected to the MPLS VPN superbackbone</b></code>.
</p>
<p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
<code style="font-size:130%">
R5(config-router)#<b>do show ip ospf 1001</b>                            <br>
 Routing Process "ospf 1001" with ID 10.255.58.1                  <br>
&nbsp;&nbsp; Domain ID type 0x0005, value 0.0.3.232                         <br>
 Start time: 00:15:57.372, Time elapsed: 02:33:44.228             <br>
 Supports only single TOS(TOS0) routes                            <br>
 Supports opaque LSA                                              <br>
 Supports Link-local Signaling (LLS)                              <br>
 Supports area transit capability                                 <br>
 Supports NSSA (compatible with RFC 3101)                         <br>
 <span style="background:gray;">Connected to MPLS VPN Superbackbone, VRF CUST_X_2</span>     <br>
 Event-log disabled                                               <br>
 It is an area border and autonomous system boundary router       <br>
 Redistributing External Routes from,                             <br>
&nbsp;&nbsp;&nbsp;&nbsp;bgp 100, includes subnets in redistribution                   <br>
 Router is not originating router-LSAs with maximum metric        <br>
 Initial SPF schedule delay 5000 msecs                            <br>
 Minimum hold time between two consecutive SPFs 10000 msecs       <br>
 Maximum wait time between two consecutive SPFs 10000 msecs       <br>
 Incremental-SPF disabled                                         <br>
 Minimum LSA interval 5 secs                                      <br>
 Minimum LSA arrival 1000 msecs                                   <br>
 LSA group pacing timer 240 secs                                  <br>
 Interface flood pacing timer 33 msecs                            <br>
 Retransmission pacing timer 66 msecs                             <br>
 Number of external LSA 0. Checksum Sum 0x000000                  <br>
 Number of opaque AS LSA 0. Checksum Sum 0x000000                 <br>
 Number of DCbitless external and opaque AS LSA 0                 <br>
 Number of DoNotAge external and opaque AS LSA 0                  <br>
 Number of areas in this router is 1. 1 normal 0 stub 0 nssa      <br>
 Number of areas transit capable is 0                             <br>
 External flood list length 0                                     <br>
 IETF NSF helper support enabled                                  <br>
 Cisco NSF helper support enabled                                 <br>
 Reference bandwidth unit is 100 mbps                             <br>
&nbsp;&nbsp;&nbsp;&nbsp;Area 1&nbsp;&nbsp;&nbsp;&nbsp;                                                    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of interfaces in this area is 1                    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Area has no authentication                                <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPF algorithm last executed 02:31:05.160 ago              <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPF algorithm executed 4 times                            <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Area ranges are                                           <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of LSA 9. Checksum Sum 0x059C39                    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of opaque link LSA 0. Checksum Sum 0x000000        <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of DCbitless LSA 0                                 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of indication LSA 0                                <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of DoNotAge LSA 0                                  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flood list length 0                                       <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                    <br>
R5(config-router)#<b>end</b></br>
</code></div>
</p>
<p>
The superbackbone is a hierarchy above area 0. With a superbackbone hierarchy in the 
OSPF domain, permitted hierarchies include:
<ul>
  <li>Super-backbone (MPLS)&rarr; Area 0 &rarr; Area 1</li>
  <li>Super-backbone (MPLS)&rarr; Area 1 &rarr; Area 1</li>
  Not permitted is: 
  <li>Super-backbone (MPLS)&rarr; Area 1 &rarr; Area 0. 
  Here, a virtual link would be required to be configured to connect the Area 0 to 
the superbackbone as it would be considered a discontiguous area.
  </li> 
</ul>
</p>

<h4>Traffic Enginneering: Primary and Backup Paths</h4>
<p>
Load-balancing across multiple paths can be accomplished by modifying the OSPF
 process ID or OSPF domain number. This results in some paths becoming external 
 routes. OSPF always chooses internal routes over external routes.
</p>

<h4>OSPF Sham-links</h4>
<p>
OSPF sham-links are similar to virtual links going over the SP network. It does 
not have to be in area 0.
</p>
<p>
To configure OSPF sham-links:
<ol>
  <li><b>Advertise a new prefix (/32) of a loopback into the VRF and advertise this into BGP:</b>
  Remember, the netmask must be /32 for this feature to work. This is done on 
  both PE devices.
  </li>
  <li>Verify IP connectivity between the two /32 prefixes.</li>
  <li>Under the OSPF process, configure the sham-link
  <code><b>area 1 sham-link 8.8.8.8 3.3.3.3</b></code>. where 8.8.8.8 is the 
  source(/32 of local device)and 3.3.3.3 is remote OSPF device. Do the same 
  but in the reverse direction on the remote device.
  
  </li>
  <li>Verify with the command <code><b>show ip ospf &lt;process-id&gt; neighbor</b></code>. It 
  shows neighborship over the sham-link.
  routes that were previously learned thru BGP are now learned thru OSPF (because 
  of lower AD); verify this on PE router using command: <code><b>show ip route</b></code>.
</ol>
</p>
<p>
Practical use case is that if you had a point-to-point VPN and you are migrating to 
MPLS L3VPN from legacy frame relay service, the backdoor link will be preferred 
from an OSPF point of view because intra-area is preferred to inter-area preferred 
to external routes.
</p>
<p>
Traffic engineering can be implemented based on the cost. 
</p>
<h4>Load-balancing</h4>
<p>
If the SP network employs the use of BGP route reflector, and will only 
advertise what it considers as the best path of the available paths and not 
use the available paths simultaneously. For RR groups these updates based on the 
RD and performs path selection between the two of them.

To enable the RR to use both paths, we need to configure different RDs so that the 
RR can advertise both paths to the remote PE. The RR will receive these as two 
separate and independent best paths and they can be advertised to the remote neighbor.

The command <code><b>maximum-paths &lt;value&gt;</b></code> needs to be configured 
to enable multipaths.
</p>

<h3>BGP as PE-CE</h3>
<p>
If prefixes are to be shared using BGP as the protocol between at the PE-CE interconnection, 
on the PE device, the peering should be implemented in the VRF address-family.

At the CE devices, the ASN for BGP should be the same. However, because BGP will 
detect the same ASN, it will reject the advertised route to prevent loop formation.
There are two fixes for this:
<ul>
<li>On the CE, configure the neighbor with the command <code><b>allow-as-in</b></code></li>
<li>Alternatively, on the PE, <code><b>as-override</b></code> to the CE iBGP peer on both 
ends of the LSP.</li>
</ul>
</p>
<p>
Loops can be introduced by the above configuration options. One solution is the 
<b>BGP site-of-origin</b>.
Under BGP SOO, prefixes from one site are tagged with SOO code (say 1000:1) as they move to the PE.
This gets advertised as a BGP extended community. The PE devices will filter out 
any other prefixes that have that SOO code set. This is configured on the PE device 
for the CE eBGP peer. This is configured under the VRF address-family.
<code><b>neighbor 155.1.67.7 soo 1000:1</b></code>.

SOO can be verified with command <code><b>show bgp vpnv4 unicast all &lt;prefix&gt;</b></code>.

Lookout for SoO.
</p>
<h4>Verification</h4>
<p>
On the RR to confirm sharing of prefixes with PE: 
<code><b>show bgp vpnv4 unicast all neighbors &lt;neighbor-ip-address&gt; advertised-routes</b></code>.
</p>

<h2>Step 6: Test Connectivity</h2>
<p>
A ping test or traceroute test can be used to confirm the operation of the MPLS L3VPN.
</p>
<p>
<h3><code style="font-size:120%;">traceroute</code></h3>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
R7><b>traceroute 10.9.1.1</b>                                             <br>
Type escape sequence to abort.                                            <br>
Tracing the route to 10.9.1.1                                             <br>
VRF info: (vrf in name/id, vrf out name/id)                               <br>
&nbsp;&nbsp;1 10.255.67.2 20 msec 16 msec 20 msec                                   <br>
&nbsp;&nbsp;2 30.255.46.1 [MPLS: Labels 4003/1000 Exp 0] 124 msec 92 msec 104 msec  <br>
&nbsp;&nbsp;3 30.255.24.1 [MPLS: Labels 2006/1000 Exp 0] 144 msec 52 msec 76 msec   <br>
&nbsp;&nbsp;4 10.255.19.1 [MPLS: Label 1000 Exp 0] 28 msec 76 msec 56 msec          <br>
&nbsp;&nbsp;5 10.255.19.2 112 msec *  104 msec
</code></div>
</p>

<p>
In the output of the traceroute command, two 
(2) MPLS labels are displayed; one label is the transport (MPLS) label and the 
other label is the VPN label. This confirms operation of MPLS L3VPN. In this case, 
the transport label is 4003 and VPN label 1000. As can be noticed, the transport
label is continually swapped from 4003 to 2006 as the packet is switched from hop to hop while the
VPN label is maintained with the packet from the ingress PE across the LSP 
to the egress PE where it finally gets popped and the packet is then redistributed
into the IGP at the PE-CE link and routed using IP.
</p>

<h3><code style="font-size:120%;">ping</code></h3>
<p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
R7><b>ping 10.9.2.1</b>                                              <br>
Type escape sequence to abort.                                       <br>
Sending 5, 100-byte ICMP Echos to 10.9.2.1, timeout is 2 seconds:    <br>
!!!!!                                                                <br>
Success rate is 100 percent (5/5), round-trip min/avg/max = 44/65/100 ms

</code></div>
</p>
<p>
The ping command confirms the connectivity from customer site to remote customer site across the SP MPLS L3VPN.
</p>
<p>
To view the MPLS LFIB
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
R6><b>show mpls forwarding-table</b>                                          <br>      
Local&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Outgoing&nbsp;&nbsp; Prefix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bytes Label&nbsp;&nbsp; Outgoing&nbsp;&nbsp; Next Hop      <br>
Label&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Label&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or Tunnel Id&nbsp;&nbsp;&nbsp;&nbsp; Switched&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interface&nbsp;&nbsp;&nbsp;&nbsp;            <br>
16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Pop Label&nbsp;&nbsp;30.255.114.0/30&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4006&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.255.112.0/30&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5024&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.255.112.0/30&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Pop Label&nbsp;&nbsp;30.255.24.0/30&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
19&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.255.11.11/32&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5022&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.255.11.11/32&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4012&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.255.2.2/32&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4023&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.2.10.1/32&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Pop Label&nbsp;&nbsp;30.255.5.5/32&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4003&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.255.1.1/32&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Pop Label&nbsp;&nbsp;30.255.115.0/30&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4007&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.255.113.0/30&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.255.113.0/30&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
26&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4009&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.255.12.0/30&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
27&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4005&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.255.13.0/30&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5003&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.255.13.0/30&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4004&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.255.35.0/30&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5037&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.255.35.0/30&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
29&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4011&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.255.3.3/32&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5004&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.255.3.3/32&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
Local&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Outgoing&nbsp;&nbsp; Prefix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bytes Label&nbsp;&nbsp; Outgoing&nbsp;&nbsp; Next Hop      <br>
Label&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Label&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or Tunnel Id&nbsp;&nbsp;&nbsp;&nbsp; Switched&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interface&nbsp;&nbsp;&nbsp;&nbsp;            <br>
30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4013&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.10.1/32&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5005&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.10.1/32&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
31&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4014&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.9.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5006&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.9.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4015&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.8.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5007&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.8.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4016&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.7.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5008&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.7.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4017&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.6.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5009&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.6.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
35&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4018&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.5.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5010&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.5.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
36&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4019&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.4.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5011&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.4.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
37&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4020&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.3.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5012&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.3.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4021&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.2.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5013&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.2.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
39&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4022&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.1.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5014&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.3.1.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi1/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.56.1   <br>
40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 10.7.3.0/24[V]&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi2/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.67.1   <br>
41&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Pop Label&nbsp;&nbsp;30.255.4.4/32&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
Local&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Outgoing&nbsp;&nbsp; Prefix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bytes Label&nbsp;&nbsp; Outgoing&nbsp;&nbsp; Next Hop      <br>
Label&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Label&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or Tunnel Id&nbsp;&nbsp;&nbsp;&nbsp; Switched&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interface&nbsp;&nbsp;&nbsp;&nbsp;            <br>
42&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 30.4.10.1/32&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
43&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 30.4.9.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
44&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 30.4.8.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
45&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 30.4.7.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
46&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 30.4.6.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
47&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 30.4.5.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
48&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 30.4.4.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
49&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 30.4.3.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 10.10.255.1/32[V]&nbsp;&nbsp; \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi2/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.67.1   <br>
51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 10.255.67.0/30[V]&nbsp;&nbsp; \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2372&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggregate/CUST_Z_HQ      <br>
52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4024&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.2.9.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4025&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.2.8.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
54&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4026&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.2.7.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4027&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.2.6.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4028&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.2.5.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4029&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.2.4.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4030&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.2.3.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4031&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.2.2.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4032&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.2.1.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 10.7.1.0/24[V]&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi2/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.67.1   <br>
Local&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Outgoing&nbsp;&nbsp; Prefix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bytes Label&nbsp;&nbsp; Outgoing&nbsp;&nbsp; Next Hop      <br>
Label&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Label&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or Tunnel Id&nbsp;&nbsp;&nbsp;&nbsp; Switched&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interface&nbsp;&nbsp;&nbsp;&nbsp;            <br>
62&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 10.7.4.0/24[V]&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi2/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.67.1   <br>
63&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 10.7.2.0/24[V]&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi2/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.67.1   <br>
64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 10.7.5.0/24[V]&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi2/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.67.1   <br>
65&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 30.4.2.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
66&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No Label&nbsp;&nbsp; 30.4.1.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
67&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Pop Label&nbsp;&nbsp;30.4.40.0/24&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gi0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1   <br>
R6>                                                                           
</code></div>
</p>
<p>
L3VPN routes have a [V] next to the learned route.

To view the FIB for the different VRFs run the command <code style="font-size:120%;"><b>show ip cef vrf &lt;vrf_name&gt;</b></code>.
</p>
<p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
R6><b>show ip cef vrf CUST_Z_HQ</b><br/>
Prefix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next Hop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Interface&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
0.0.0.0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no route&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
0.0.0.0/8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
0.0.0.0/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; receive&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
10.7.1.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.67.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GigabitEthernet2/0  <br>
10.7.2.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.67.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GigabitEthernet2/0  <br>
10.7.3.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.67.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GigabitEthernet2/0  <br>
10.7.4.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.67.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GigabitEthernet2/0  <br>
10.7.5.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.255.67.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GigabitEthernet2/0  <br>
10.9.1.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GigabitEthernet0/0  <br>
10.9.2.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GigabitEthernet0/0  <br>
10.9.3.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GigabitEthernet0/0  <br>
10.9.4.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.255.46.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GigabitEthernet0/0  <br>
10.10.255.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10.255.67.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GigabitEthernet2/0  <br>
10.255.19.0/30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.255.46.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GigabitEthernet0/0  <br>
10.255.67.0/30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; attached&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GigabitEthernet2/0  <br>
10.255.67.0/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; receive&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GigabitEthernet2/0  <br>
10.255.67.1/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; attached&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GigabitEthernet2/0  <br>
10.255.67.2/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; receive&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GigabitEthernet2/0  <br>
10.255.67.3/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; receive&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GigabitEthernet2/0  <br>
127.0.0.0/8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
224.0.0.0/4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
224.0.0.0/24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; receive&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
Prefix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next Hop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Interface&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
240.0.0.0/4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>
255.255.255.255/32&nbsp;&nbsp; receive
</code></div>
</p>
<p>
Additionally, to view the MPLS L3VPN on a specific route in the VRF LIB
</p>
<p>
<div style="background-color:#f4f0ec; border-style:solid;border-width:1px;border-color:#D3D3D3">
      	<code style="font-size:130%">
R6><b>show ip cef vrf CUST_Z_HQ 10.9.1.0</b>               <br>         
10.9.1.0/24                                                <br>  
&nbsp;&nbsp;nexthop 30.255.46.1 GigabitEthernet0/0 label 4003 1000   <br>  
R6>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                <br>  
R6><b>show ip cef vrf CUST_Z_HQ 10.7.1.0</b>               <br>         
10.7.1.0/24                                                <br>  
&nbsp;&nbsp;nexthop 10.255.67.1 GigabitEthernet2/0                   <br>                                                 
R6><b>show ip cef vrf CUST_Z_HQ 10.7.1.0 detail</b>        <br>         
10.7.1.0/24, epoch 0                                       <br>  
&nbsp;&nbsp;local label info: other/61                               <br>  
&nbsp;&nbsp;nexthop 10.255.67.1 GigabitEthernet2/0                   <br>  
R6><b>show ip cef vrf CUST_Z_HQ 10.9.1.0 detail</b>        <br>         
10.9.1.0/24, epoch 0, flags rib defined all labels         <br>  
&nbsp;&nbsp;recursive via 30.255.1.1 label 1000                      <br>  
&nbsp;&nbsp;&nbsp;&nbsp;nexthop 30.255.46.1 GigabitEthernet0/0 label 4003      <br>  
R6>                                                          
</code></div>
</p>

<h1 id="TROUBLESHOOTING">Troubleshooting</h1>
<h2>LDP Adjacency</h2>
<p>
<ul>
  <li>Is LDP actually enabled: <code><b>show mpls interfaces</b></code></li>
  <li>Is LDP transport working: <code><b>dbug mpls ldp transport events</b></code></li>
  <li>Is LDP session authenticated: LDP(like BGP) uses TCP auth (option 19)</li>
</ul>
</p>
<h2>LDP Advertisements</h2>
<p>
Advertise labels for all IGP learned routes.
<ul>
<li>Are labels actually bound:
<ul>
  <li><code><b>show mpls ldp binding</b></code></li>
  <li><code><b>show mpls forwarding-table</b></code></li>
  <li><code><b>debug mpls ldp binding</b></code></li>
  <li><code><b>debug mpls ldp transport events</b></code>: able to view LDP 
  messages being exchanged. If an LDP peer does not have a route to its neighbor's 
  LDP ID, this debug command will display this appropriate message.</li>
</ul>
</li>
<li>Is allocation being filtered?:
<ul>
  <li>Advertise filter vs. allocate filter: labels can be advertised for prefixes 
  that are in a specified access-list. It is important to advertise labels for 
  all IGP learned routes.</li>
  <li>Typically only /32 needs an allocation.</li>
 </ul>
 </li>
</ul>
</p>

<h2>PE-CE Routing</h2>
<p>
<ul>
<li>Is loop prevention being violated?:
  <ul>
    <li>OSPF don-bit and domain-tag</li>
    <li>BGP AS-Path and Site-of-Origin(SoO)</li>
    <li>EIGRP Site-of-Origin</li>
  </ul>
</li>
<li>Is the VRF just hung?
  <ul>
  <li><code><b>clear ip route vrf *</b></code></li>
  <li>Forces re-import/export</li>
  </ul>
</li>
</ul>
</p>

<h2>VPNv4 BGP</h2>

<h3>Is the route-target being filtered</h3>
<p>
<ul>
  <li>Wrong import/export policy</li>
  <li>Default route-target filter</li>
  <li>VPNv4 Route reflection</li>
</ul>
<code><b>debug bgp vpnv4 unicast updates</b></code> to view debugging messages 
associated with VPNv4 failures. Critical error message is "DENIED due to: extended 
community not supported". <code><b>show vrf detail</b></code>.
</p>


<h3>Are VPNv4 routes being sent/received</h3>
<p>
<ul>
  <li><code><b>show bgp vpnv4 unicast all  </b></code></li>
  <li><code><b>show bgp vpnv4 unicast all &lt;prefix&gt; </b></code>:
  The in() and out MPLS labels of a prefix can be viewed.
  </li>
  <li><code><b>show bgp vpnv4 unicast all neighbor advertised-routes  </b></code></li>
  <li><code><b> debug bgp vpnv4 unicast updates </b></code></li>
  <li><code><b> clear bgp vpnv4 unicast * &lt;in|out&gt;</b></code></li>
</ul>
</p>

<h2>MPLS Data Plane</h2>
<p>
<li>Is the VPNv4 peering to a /32? The loopback needs to be a /32 netmask for the 
VPN data plane to work. 
  <ul>  
    <li>PHP may happen one hop too soon if peering to the wrong address. This will result 
in a traffic blackhole.</li>
<li>Problems in route summarization.</li>
</ul>
<li>Are LDP and IGP synced? LFIB can only install label for RIB.LRIB intersection</li>
</p>